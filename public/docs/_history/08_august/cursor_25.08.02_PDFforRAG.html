
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="http://localhost:3000/docs/_history/08_august/cursor_25.08.02_PDFforRAG.html">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Entwicklung einer Daten-Transformationsstrategie - Common Knowledge Scout</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../css/print-site.css">
    
      <link rel="stylesheet" href="../../css/print-site-material.css">
    
      <link rel="stylesheet" href="../../assets/stylesheets/print.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#entwicklung-einer-daten-transformationsstrategie" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Common Knowledge Scout" class="md-header__button md-logo" aria-label="Common Knowledge Scout" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Common Knowledge Scout
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Entwicklung einer Daten-Transformationsstrategie
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/bCommonsLAB/CommonKnowledgeScout" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Common Knowledge Scout" class="md-nav__button md-logo" aria-label="Common Knowledge Scout" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Common Knowledge Scout
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bCommonsLAB/CommonKnowledgeScout" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Overview
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Start
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/intro.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Intro
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../overview/features.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Features
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Architecture
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Architecture
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Start
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/architecture.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../architecture/core-components.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Core Components
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Guide
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Start
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/setup.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/getting-started.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/settings.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Settings
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/library.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Using the Library
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/event-monitor.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Event Monitor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/batch-session-import.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Batch Session Import
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/troubleshooting.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../guide/faq.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Concepts
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Concepts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Start
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/storage-provider.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Storage Provider
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/localstorage.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FileSystem (Local)
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/image-transformation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Image Transformation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/pdf/extraction-methods.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    PDF Extraction
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/metadata.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Metadata
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_7" >
        
          
          <label class="md-nav__link" for="__nav_5_7" id="__nav_5_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Library
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_7">
            <span class="md-nav__icon md-icon"></span>
            Library
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/library/overview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/library/global-state.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Global State
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/library/header.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Header
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/library/breadcrumb.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Breadcrumb
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/library/file-tree.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FileTree
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/library/file-list.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FileList
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/library/upload.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Upload
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/library/file-preview.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FilePreview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/library/transcription.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transcription
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/library/transform.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/library/batch-transcription.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Batch Transcription
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/library/error-handling-logging-testing.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Error Handling & Tests
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/library/initialization-sequence.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Initialization
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/library/components.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Library Components
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/features/shadowtwins.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Shadow-Twin
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/features/extended-shadowtwin.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Extended Shadow-Twin
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/features/transformation-service.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Transformation Service
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../concepts/video-transformation.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Video Transformation
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Start
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/glossary.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Glossary
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/api/secretary-services.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Secretary Services
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/api/track-processor.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Track Processor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../chat-response-generation-process.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Chat & Story Mode
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Operations
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Operations
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ops/index.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Start
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ops/deployment/docker.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Docker Deployment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ops/desktop/quick-setup.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Electron Quick Setup
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ops/desktop/package-strategy.html" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Electron Package Strategy
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-grundlagen-fur-die-daten-transformation-festigen" class="md-nav__link">
    <span class="md-ellipsis">
      1. Grundlagen f√ºr die Daten-Transformation festigen
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-kategorisierung-und-klassifizierung" class="md-nav__link">
    <span class="md-ellipsis">
      2. Kategorisierung und Klassifizierung
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-erweiterung-der-suche-und-filterlogik" class="md-nav__link">
    <span class="md-ellipsis">
      3. Erweiterung der Suche und Filterlogik
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-interaktive-benutzeroberflache-chatbotagent" class="md-nav__link">
    <span class="md-ellipsis">
      4. Interaktive Benutzeroberfl√§che (Chatbot/Agent)
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-transparenz-teilhabe-und-dokumentation" class="md-nav__link">
    <span class="md-ellipsis">
      5. Transparenz, Teilhabe und Dokumentation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-visionare-schritteweiterentwicklung" class="md-nav__link">
    <span class="md-ellipsis">
      6. Vision√§re Schritte/Weiterentwicklung
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Vision√§re Schritte/Weiterentwicklung">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pragmatische-roadmap-in-reihenfolge" class="md-nav__link">
    <span class="md-ellipsis">
      Pragmatische Roadmap (in Reihenfolge)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aktueller-stand-du-hast-bereits-implementiert" class="md-nav__link">
    <span class="md-ellipsis">
      Aktueller Stand - Du hast bereits implementiert:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Aktueller Stand - Du hast bereits implementiert:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-pdf-zu-markdown-transformation-vollstandig-vorhanden" class="md-nav__link">
    <span class="md-ellipsis">
      ‚úÖ 1. PDF-zu-Markdown-Transformation - VOLLST√ÑNDIG VORHANDEN
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-metadaten-schema-sehr-ausgereift" class="md-nav__link">
    <span class="md-ellipsis">
      ‚úÖ 2. Metadaten-Schema - SEHR AUSGEREIFT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-such-und-filterlogik-implementiert" class="md-nav__link">
    <span class="md-ellipsis">
      ‚úÖ 3. Such- und Filterlogik - IMPLEMENTIERT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-batch-automatisierung-vorhanden" class="md-nav__link">
    <span class="md-ellipsis">
      ‚úÖ 4. Batch-Automatisierung - VORHANDEN
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#was-noch-fehlt-fur-deine-vision" class="md-nav__link">
    <span class="md-ellipsis">
      Was noch FEHLT f√ºr deine Vision:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Was noch FEHLT f√ºr deine Vision:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#chatbotagent-fur-naturliche-interaktion" class="md-nav__link">
    <span class="md-ellipsis">
      ‚ùå Chatbot/Agent f√ºr nat√ºrliche Interaktion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#automatische-inhaltsverzeichnisse" class="md-nav__link">
    <span class="md-ellipsis">
      ‚ö†Ô∏è Automatische Inhaltsverzeichnisse
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sharingpublishing-mechanismus" class="md-nav__link">
    <span class="md-ellipsis">
      ‚ö†Ô∏è Sharing/Publishing-Mechanismus
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#meine-empfohlene-angepasste-roadmap" class="md-nav__link">
    <span class="md-ellipsis">
      Meine empfohlene angepasste Roadmap:
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Meine empfohlene angepasste Roadmap:">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#sofort-umsetzbar-woche-1-2" class="md-nav__link">
    <span class="md-ellipsis">
      Sofort umsetzbar (Woche 1-2):
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mittelfristig-woche-3-4" class="md-nav__link">
    <span class="md-ellipsis">
      Mittelfristig (Woche 3-4):
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aktueller-stand-sehr-gut-als-basis-geeignet" class="md-nav__link">
    <span class="md-ellipsis">
      Aktueller Stand (sehr gut als Basis geeignet):
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Aktueller Stand (sehr gut als Basis geeignet):">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#jobbatch-system" class="md-nav__link">
    <span class="md-ellipsis">
      ‚úÖ Job/Batch-System
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#event-monitor" class="md-nav__link">
    <span class="md-ellipsis">
      ‚úÖ Event-Monitor
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#erweiterungskonzept-fur-pdf-seitenzerteilung" class="md-nav__link">
    <span class="md-ellipsis">
      Erweiterungskonzept f√ºr PDF-Seitenzerteilung:
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deine-ziel-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      üéØ Deine Ziel-Pipeline:
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#aktueller-stand-des-eventsession-systems" class="md-nav__link">
    <span class="md-ellipsis">
      üìä Aktueller Stand des Event/Session-Systems
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üìä Aktueller Stand des Event/Session-Systems">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vorhandene-starken" class="md-nav__link">
    <span class="md-ellipsis">
      ‚úÖ Vorhandene St√§rken:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#erweiterungen-fur-dokument-verarbeitung" class="md-nav__link">
    <span class="md-ellipsis">
      üîÑ Erweiterungen f√ºr Dokument-Verarbeitung:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#neue-job-types-fur-dokumentverarbeitung" class="md-nav__link">
    <span class="md-ellipsis">
      üîÑ Neue Job-Types f√ºr Dokumentverarbeitung:
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#abhangigkeiten-zwischen-jobs" class="md-nav__link">
    <span class="md-ellipsis">
      Abh√§ngigkeiten zwischen Jobs
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitoring-und-status" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring und Status
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integration-mit-bestehenden-komponenten" class="md-nav__link">
    <span class="md-ellipsis">
      Integration mit bestehenden Komponenten
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kernproblem-analyse" class="md-nav__link">
    <span class="md-ellipsis">
      üéØ Kernproblem-Analyse
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#konzeptionsplan-generischer-processing-stack" class="md-nav__link">
    <span class="md-ellipsis">
      üìã Konzeptionsplan: Generischer Processing-Stack
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üìã Konzeptionsplan: Generischer Processing-Stack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-zentrales-datenmodell-documentchunk" class="md-nav__link">
    <span class="md-ellipsis">
      1. Zentrales Datenmodell: DocumentChunk
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-format-agnostische-import-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      2. Format-Agnostische Import-Pipeline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-intelligente-metadaten-pipeline" class="md-nav__link">
    <span class="md-ellipsis">
      3. Intelligente Metadaten-Pipeline
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-kapitel-erkennung-multi-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      4. Kapitel-Erkennung (Multi-Strategy)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-rag-optimierte-chapter-summaries" class="md-nav__link">
    <span class="md-ellipsis">
      5. RAG-Optimierte Chapter-Summaries
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-phasen-implementierungs-roadmap" class="md-nav__link">
    <span class="md-ellipsis">
      üó∫Ô∏è 5-Phasen Implementierungs-Roadmap
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üó∫Ô∏è 5-Phasen Implementierungs-Roadmap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phase-1-fundament-woche-1-2" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 1: Fundament (Woche 1-2)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-2-metadaten-intelligence-woche-3-4" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 2: Metadaten-Intelligence (Woche 3-4)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-3-ui-monitoring-woche-5" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 3: UI &amp; Monitoring (Woche 5)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-4-rag-integration-woche-6-7" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 4: RAG-Integration (Woche 6-7)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-5-skalierung-woche-8" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 5: Skalierung (Woche 8)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kritische-erfolgskriterien" class="md-nav__link">
    <span class="md-ellipsis">
      üéØ Kritische Erfolgskriterien
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üéØ Kritische Erfolgskriterien">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quantitative-ziele" class="md-nav__link">
    <span class="md-ellipsis">
      Quantitative Ziele:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#qualitative-ziele" class="md-nav__link">
    <span class="md-ellipsis">
      Qualitative Ziele:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#risiko-mitigation" class="md-nav__link">
    <span class="md-ellipsis">
      üöß Risiko-Mitigation
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kritische-designentscheidungen-die-wir-klaren-sollten" class="md-nav__link">
    <span class="md-ellipsis">
      ü§î Kritische Designentscheidungen, die wir kl√§ren sollten:
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#architektur-verteilung" class="md-nav__link">
    <span class="md-ellipsis">
      üèóÔ∏è Architektur-Verteilung
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üèóÔ∏è Architektur-Verteilung">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#knowledge-scout-nextjs-frontend" class="md-nav__link">
    <span class="md-ellipsis">
      Knowledge Scout (Next.js Frontend)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#secretary-service-python-backend" class="md-nav__link">
    <span class="md-ellipsis">
      Secretary Service (Python Backend)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dein-zweistufiger-prototyp-plan" class="md-nav__link">
    <span class="md-ellipsis">
      üìã Dein Zweistufiger Prototyp-Plan
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üìã Dein Zweistufiger Prototyp-Plan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stufe-1-seitenweise-verarbeitung-secretary-service" class="md-nav__link">
    <span class="md-ellipsis">
      Stufe 1: Seitenweise Verarbeitung (Secretary Service)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stufe-2-globale-kapitel-analyse-secretary-service" class="md-nav__link">
    <span class="md-ellipsis">
      Stufe 2: Globale Kapitel-Analyse (Secretary Service)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prototyp-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      üîÑ Prototyp-Workflow
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#konkreter-implementierungsplan" class="md-nav__link">
    <span class="md-ellipsis">
      üõ†Ô∏è Konkreter Implementierungsplan
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üõ†Ô∏è Konkreter Implementierungsplan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#phase-1-secretary-service-erweitern" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 1: Secretary Service erweitern
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Phase 1: Secretary Service erweitern">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#neuer-endpoint-pdfprocess-pagewise" class="md-nav__link">
    <span class="md-ellipsis">
      Neuer Endpoint: /pdf/process-pagewise
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#neuer-endpoint-pdfanalyze-chapters" class="md-nav__link">
    <span class="md-ellipsis">
      Neuer Endpoint: /pdf/analyze-chapters
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-2-knowledge-scout-orchestrierung" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 2: Knowledge Scout Orchestrierung
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Phase 2: Knowledge Scout Orchestrierung">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#neuer-job-typ-pdf_advanced_analysis" class="md-nav__link">
    <span class="md-ellipsis">
      Neuer Job-Typ: pdf_advanced_analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#erweiterte-orchestrierung" class="md-nav__link">
    <span class="md-ellipsis">
      Erweiterte Orchestrierung:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prototyp-test-mit-echtem-biodiv-pdf" class="md-nav__link">
    <span class="md-ellipsis">
      üß™ Prototyp-Test mit echtem Biodiv-PDF
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üß™ Prototyp-Test mit echtem Biodiv-PDF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-szenario" class="md-nav__link">
    <span class="md-ellipsis">
      Test-Szenario:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#success-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Success Metrics:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nachste-schritte-entscheidung" class="md-nav__link">
    <span class="md-ellipsis">
      ‚ùì N√§chste Schritte - Entscheidung
    </span>
  </a>
  
    <nav class="md-nav" aria-label="‚ùì N√§chste Schritte - Entscheidung">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#neuer-endpoint-pdfanalyze-chapters_1" class="md-nav__link">
    <span class="md-ellipsis">
      Neuer Endpoint: /pdf/analyze-chapters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#phase-2-knowledge-scout-orchestrierung_1" class="md-nav__link">
    <span class="md-ellipsis">
      Phase 2: Knowledge Scout Orchestrierung
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Phase 2: Knowledge Scout Orchestrierung">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#neuer-job-typ-pdf_advanced_analysis_1" class="md-nav__link">
    <span class="md-ellipsis">
      Neuer Job-Typ: pdf_advanced_analysis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#erweiterte-orchestrierung_1" class="md-nav__link">
    <span class="md-ellipsis">
      Erweiterte Orchestrierung:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#prototyp-test-mit-echtem-biodiv-pdf_1" class="md-nav__link">
    <span class="md-ellipsis">
      üß™ Prototyp-Test mit echtem Biodiv-PDF
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üß™ Prototyp-Test mit echtem Biodiv-PDF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-szenario_1" class="md-nav__link">
    <span class="md-ellipsis">
      Test-Szenario:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#success-metrics_1" class="md-nav__link">
    <span class="md-ellipsis">
      Success Metrics:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nachste-schritte-entscheidung_1" class="md-nav__link">
    <span class="md-ellipsis">
      ‚ùì N√§chste Schritte - Entscheidung
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#korrekte-rag-logik" class="md-nav__link">
    <span class="md-ellipsis">
      üéØ Korrekte RAG-Logik
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üéØ Korrekte RAG-Logik">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#zwei-dokument-ansatz-pro-kapitel" class="md-nav__link">
    <span class="md-ellipsis">
      Zwei-Dokument-Ansatz pro Kapitel:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rag-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      RAG-Workflow:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage-organisation-im-knowledge-scout" class="md-nav__link">
    <span class="md-ellipsis">
      üìÅ Storage-Organisation im Knowledge Scout
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üìÅ Storage-Organisation im Knowledge Scout">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#verzeichnis-struktur" class="md-nav__link">
    <span class="md-ellipsis">
      Verzeichnis-Struktur:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#angepasster-prototyp-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      üîÑ Angepasster Prototyp-Workflow
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üîÑ Angepasster Prototyp-Workflow">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#stufe-1-seitenweise-verarbeitung-unverandert" class="md-nav__link">
    <span class="md-ellipsis">
      Stufe 1: Seitenweise Verarbeitung (unver√§ndert)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stufe-2-kapitel-analyse-angepasst" class="md-nav__link">
    <span class="md-ellipsis">
      Stufe 2: Kapitel-Analyse (angepasst)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#stufe-3-storage-im-knowledge-scout" class="md-nav__link">
    <span class="md-ellipsis">
      Stufe 3: Storage im Knowledge Scout
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#angepasste-secretary-service-endpoints" class="md-nav__link">
    <span class="md-ellipsis">
      üõ†Ô∏è Angepasste Secretary Service Endpoints
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üõ†Ô∏è Angepasste Secretary Service Endpoints">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pdfanalyze-chapters-response" class="md-nav__link">
    <span class="md-ellipsis">
      /pdf/analyze-chapters Response:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#knowledge-scout-storage-logik" class="md-nav__link">
    <span class="md-ellipsis">
      üìÇ Knowledge Scout Storage-Logik
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üìÇ Knowledge Scout Storage-Logik">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#erweiterte-storageprovider-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Erweiterte StorageProvider Integration:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#rag-integration-vorbereitung" class="md-nav__link">
    <span class="md-ellipsis">
      üéØ RAG-Integration Vorbereitung
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üéØ RAG-Integration Vorbereitung">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#vector-search-index" class="md-nav__link">
    <span class="md-ellipsis">
      Vector Search Index:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rag-query-workflow" class="md-nav__link">
    <span class="md-ellipsis">
      RAG Query Workflow:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#angepasster-prototyp-test" class="md-nav__link">
    <span class="md-ellipsis">
      üß™ Angepasster Prototyp-Test
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üß™ Angepasster Prototyp-Test">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-ziele" class="md-nav__link">
    <span class="md-ellipsis">
      Test-Ziele:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#erfolgs-kriterien" class="md-nav__link">
    <span class="md-ellipsis">
      Erfolgs-Kriterien:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="entwicklung-einer-daten-transformationsstrategie">Entwicklung einer Daten-Transformationsstrategie<a class="headerlink" href="#entwicklung-einer-daten-transformationsstrategie" title="Permanent link">&para;</a></h1>
<p><em>Exported on 8/2/2025 at 13:32:54 GMT+2 from Cursor (1.3.8)</em></p>
<hr />
<p><strong>User</strong></p>
<p>Ich habe dieses Projekt weiter analysiert, mit folgendem Ergebnis:
Basierend auf deinen bisherigen √úberlegungen und dem aktuellen Stand deiner Projekte machen folgende <strong>n√§chsten Schritte</strong> am meisten Sinn ‚Äì sowohl aus technischer Sicht als auch in Bezug auf die √ºbergeordneten Motive (Ordnung, Transparenz, Nutzbarkeit, Teilhabe):</p>
<hr />
<h2 id="1-grundlagen-fur-die-daten-transformation-festigen">1. <strong>Grundlagen f√ºr die Daten-Transformation festigen</strong><a class="headerlink" href="#1-grundlagen-fur-die-daten-transformation-festigen" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Automatisierung der PDF-zu-Markdown-Transformation</strong>
  Baue/optimiere dein Tool so, dass du gro√üe Mengen an PDFs zuverl√§ssig und inkl. Metadaten in Markdown umwandeln kannst.</li>
<li><strong>Standardisierung der Metadaten</strong>
  Definiere ein einheitliches Metadaten-Schema (z.‚ÄØB. f√ºr Autor, Jahr, Thema, Schlagw√∂rter, Quelle), das m√∂glichst sprach- und dom√§nenunabh√§ngig ist.</li>
<li><strong>Qualit√§tssicherung</strong>
  Entwickle einen Prozess zur √úberpr√ºfung und Korrektur der Metadaten, ggf. teilautomatisiert durch KI-Unterst√ºtzung.</li>
</ul>
<hr />
<h2 id="2-kategorisierung-und-klassifizierung">2. <strong>Kategorisierung und Klassifizierung</strong><a class="headerlink" href="#2-kategorisierung-und-klassifizierung" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Automatische Generierung von Inhaltsverzeichnissen und Summaries</strong>
  Implementiere die M√∂glichkeit, aus den Metadaten und Texten strukturierte √úbersichten/Inhaltsverzeichnisse und kurze Zusammenfassungen je Kapitel/Abschnitt zu generieren.</li>
<li><strong>Test mit realen Datens√§tzen</strong>
  Wende den Prozess konkret auf z.‚ÄØB. deinen Biodiv-Korpus an und analysiere die Ergebnisse: Sind die Themen/Schl√ºsselw√∂rter sinnvoll auffindbar? Wo gibt es noch L√ºcken?</li>
</ul>
<hr />
<h2 id="3-erweiterung-der-suche-und-filterlogik">3. <strong>Erweiterung der Suche und Filterlogik</strong><a class="headerlink" href="#3-erweiterung-der-suche-und-filterlogik" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Einbau einer Filterfunktion auf Basis der Metadaten</strong>
  Baue z.‚ÄØB. eine SQL- oder ElasticSearch-basierte Filterung, damit gezielt nach Themen, Autoren, Zeitr√§umen usw. gesucht werden kann.</li>
<li><strong>Experimente mit Vektorsuche (Embeddings) und nat√ºrlicher Sprachsuche</strong>
  Teste, wie gut KI-Modelle relevante Kapitel/Dokumente aus deinem Korpus finden.</li>
</ul>
<hr />
<h2 id="4-interaktive-benutzeroberflache-chatbotagent">4. <strong>Interaktive Benutzeroberfl√§che (Chatbot/Agent)</strong><a class="headerlink" href="#4-interaktive-benutzeroberflache-chatbotagent" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Integration des Chatbots</strong>
  Verbinde die bisherigen Datenprozesse mit einer UI, in der du mit deinem Korpus chatten, nach Themen suchen und zu Originalquellen springen kannst.</li>
<li><strong>User-Feedback einholen</strong>
  Lass andere (z.‚ÄØB. aus deinem Freundes- oder Arbeitskreis) testen, wie intuitiv die Interaktion ist. Welche Funktionen fehlen?</li>
</ul>
<hr />
<h2 id="5-transparenz-teilhabe-und-dokumentation">5. <strong>Transparenz, Teilhabe und Dokumentation</strong><a class="headerlink" href="#5-transparenz-teilhabe-und-dokumentation" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Dokumentiere die Prozesskette und die technischen Hintergr√ºnde</strong>
  Erstelle eine Schritt-f√ºr-Schritt-Anleitung/Readme, wie das System funktioniert (auch zur Weitergabe an andere Mitstreiter\:innen).</li>
<li><strong>Schnittstellen f√ºr Teilen und Ver√∂ffentlichung entwickeln</strong>
  Implementiere die M√∂glichkeit, einzelne Dateien/Ordner als ‚Äû√∂ffentlich‚Äú zu markieren und (automatisiert) zu publizieren.</li>
</ul>
<hr />
<h2 id="6-visionare-schritteweiterentwicklung">6. <strong>Vision√§re Schritte/Weiterentwicklung</strong><a class="headerlink" href="#6-visionare-schritteweiterentwicklung" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>√úbertragung auf andere Wissensbereiche</strong>
  Probiere das System mit neuen Themenfeldern und Gruppen aus (Pilotversuch).</li>
<li><strong>Konzept f√ºr kollektive Intelligenz und ShadowTwin weiterentwickeln</strong>
  Wie k√∂nnen pers√∂nliche Reflexionen, kollektive Bewertungen und Versionierung sinnvoll und transparent integriert werden?</li>
</ul>
<hr />
<h3 id="pragmatische-roadmap-in-reihenfolge"><strong>Pragmatische Roadmap (in Reihenfolge)</strong><a class="headerlink" href="#pragmatische-roadmap-in-reihenfolge" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Standard f√ºr Metadaten und Transformation definieren</strong>
   (kleines Testset durchspielen)</li>
<li><strong>Automatisierung PDF/Datei-Transformation verbessern</strong>
   (Batch-Prozess auf Biodiv-Daten)</li>
<li><strong>Filter/Suchfunktion bauen und mit Chatbot verbinden</strong></li>
<li><strong>User-Interface prototypisieren und User-Feedback einholen</strong></li>
<li><strong>Dokumentation &amp; Sharing-Mechanismus f√ºr Ergebnisse</strong></li>
<li><strong>Iterativ: Ausweitung auf weitere Themen/Teams</strong></li>
</ol>
<hr />
<p><strong>Tipp:</strong> Fokussiere zuerst auf wenige Kernfunktionen mit gro√üem Mehrwert f√ºr dich und deine Testgruppe. Lieber ein robustes, durchschaubares System aufbauen als zu viele Features auf einmal.</p>
<p>K√∂nnen wir das nachvollziehen?</p>
<hr />
<p><strong>Cursor</strong></p>
<p>Ja, das ist eine sehr durchdachte und strukturierte Roadmap! Lass mich den aktuellen Stand deines CommonKnowledgeScout-Projekts analysieren, um zu verstehen, wo du stehst und welche der vorgeschlagenen Schritte am sinnvollsten als n√§chstes angegangen werden sollten.</p>
<p>Beeindruckend! Nach der Analyse deines Projekts muss ich sagen: <strong>Du bist schon viel weiter, als du denkst!</strong> üéØ</p>
<h2 id="aktueller-stand-du-hast-bereits-implementiert">Aktueller Stand - Du hast bereits implementiert:<a class="headerlink" href="#aktueller-stand-du-hast-bereits-implementiert" title="Permanent link">&para;</a></h2>
<h3 id="1-pdf-zu-markdown-transformation-vollstandig-vorhanden">‚úÖ <strong>1. PDF-zu-Markdown-Transformation</strong> - VOLLST√ÑNDIG VORHANDEN<a class="headerlink" href="#1-pdf-zu-markdown-transformation-vollstandig-vorhanden" title="Permanent link">&para;</a></h3>
<ul>
<li>Funktionierender <code>TransformService</code> mit Secretary Service Integration</li>
<li><strong>7 verschiedene Extraktionsmethoden</strong> (native, OCR, LLM, etc.)</li>
<li>Asynchrone Verarbeitung mit Webhook-Status-Updates</li>
<li><strong>Batch-Verarbeitung</strong> f√ºr gro√üe Mengen an PDFs</li>
<li>Speicherung als "Shadow-Twins" mit strukturierten Metadaten</li>
</ul>
<h3 id="2-metadaten-schema-sehr-ausgereift">‚úÖ <strong>2. Metadaten-Schema</strong> - SEHR AUSGEREIFT<a class="headerlink" href="#2-metadaten-schema-sehr-ausgereift" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Umfangreiches wissenschaftliches Schema</strong> (Dublin Core &amp; BibTeX-kompatibel)</li>
<li>YAML-Frontmatter in Markdown mit bibliographischen, r√§umlichen, zeitlichen Daten</li>
<li>TypeScript-Interfaces f√ºr alle Metadaten-Typen</li>
<li>Automatische Metadaten-Extraktion w√§hrend Transformation</li>
</ul>
<h3 id="3-such-und-filterlogik-implementiert">‚úÖ <strong>3. Such- und Filterlogik</strong> - IMPLEMENTIERT<a class="headerlink" href="#3-such-und-filterlogik-implementiert" title="Permanent link">&para;</a></h3>
<ul>
<li>Erweiterte Kategorisierung (media, text, documents, all)</li>
<li><code>sortedFilteredFilesAtom</code> mit komplexen Filteroptionen</li>
<li>Session-Repository mit erweiterten Suchm√∂glichkeiten</li>
<li>Intelligente Batch-Auswahl basierend auf Filtern</li>
</ul>
<h3 id="4-batch-automatisierung-vorhanden">‚úÖ <strong>4. Batch-Automatisierung</strong> - VORHANDEN<a class="headerlink" href="#4-batch-automatisierung-vorhanden" title="Permanent link">&para;</a></h3>
<ul>
<li><code>BatchTransformService</code> f√ºr alle Medientypen</li>
<li>Fortschritts-Tracking und Fehlerbehandlung</li>
<li>Parallel und sequentielle Verarbeitung</li>
<li>Template-basierte Transformation</li>
</ul>
<h2 id="was-noch-fehlt-fur-deine-vision">Was noch FEHLT f√ºr deine Vision:<a class="headerlink" href="#was-noch-fehlt-fur-deine-vision" title="Permanent link">&para;</a></h2>
<h3 id="chatbotagent-fur-naturliche-interaktion">‚ùå <strong>Chatbot/Agent f√ºr nat√ºrliche Interaktion</strong><a class="headerlink" href="#chatbotagent-fur-naturliche-interaktion" title="Permanent link">&para;</a></h3>
<ul>
<li>Keine konversationelle Schnittstelle zu deinem Korpus</li>
<li>Keine Vektorsuche/Embeddings-basierte Suche</li>
<li>Keine nat√ºrlichsprachliche Abfrage</li>
</ul>
<h3 id="automatische-inhaltsverzeichnisse">‚ö†Ô∏è <strong>Automatische Inhaltsverzeichnisse</strong><a class="headerlink" href="#automatische-inhaltsverzeichnisse" title="Permanent link">&para;</a></h3>
<ul>
<li>Template-System vorhanden, aber spezifische ToC-Generierung unklar</li>
</ul>
<h3 id="sharingpublishing-mechanismus">‚ö†Ô∏è <strong>Sharing/Publishing-Mechanismus</strong><a class="headerlink" href="#sharingpublishing-mechanismus" title="Permanent link">&para;</a></h3>
<ul>
<li>Grundlagen vorhanden, aber √∂ffentliche Publikation zu pr√ºfen</li>
</ul>
<h2 id="meine-empfohlene-angepasste-roadmap">Meine empfohlene <strong>angepasste Roadmap</strong>:<a class="headerlink" href="#meine-empfohlene-angepasste-roadmap" title="Permanent link">&para;</a></h2>
<h3 id="sofort-umsetzbar-woche-1-2"><strong>Sofort umsetzbar (Woche 1-2):</strong><a class="headerlink" href="#sofort-umsetzbar-woche-1-2" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Chatbot-Integration entwickeln</strong> - Das ist der gr√∂√üte fehlende Baustein</li>
<li><strong>Vektorsuche implementieren</strong> - Embeddings f√ºr semantische Suche</li>
<li><strong>Automatische ToC-Generierung</strong> testen/optimieren</li>
</ol>
<h3 id="mittelfristig-woche-3-4"><strong>Mittelfristig (Woche 3-4):</strong><a class="headerlink" href="#mittelfristig-woche-3-4" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>User-Interface f√ºr Chat</strong> - Integration in bestehende Library-Komponenten</li>
<li><strong>Sharing-Mechanismus</strong> erweitern und testen</li>
<li><strong>Biodiv-Korpus</strong> als Pilottest durchlaufen lassen</li>
</ol>
<p><strong>Du hast eine solide technische Basis - konzentriere dich auf die fehlende AI/Chat-Schicht!</strong> </p>
<p>Soll ich dir dabei helfen, den <strong>Chatbot/Agent</strong> als n√§chsten Schritt zu implementieren? Das w√§re der gr√∂√üte Hebel f√ºr deine Vision.</p>
<hr />
<p><strong>User</strong></p>
<p>Ich glaube nicht, dass wir bei dieser PDF-Transformation in Markdown schon eine solide Basis haben. Das war ein sehr schnell entwickeltes System, das ich noch anhand von einem Text-Corpus, wie ihr den Text-Corpus jetzt weiter austesten m√∂chtet. Zum einen geht es darum, wie ich das auch in gr√∂√üeren Mengen bearbeiten kann. Wir haben hier in diesem Projekt diesen SessionManager und diesen EventMonitor, der ein spezifisches Format verarbeiten kann. Das sind diese Events und Sessions. Und ich m√∂chte gern diese Module erweitern und generisch umbauen. Dass Sie nicht nur das spezifische Format verarbeiten k√∂nnen, sondern beliebige Formate, Audio, Video, PDFs, um gro√üe Mengen zu verarbeiten.
Dort werden ja die PDFs in einzelne Seiten zerlegt und einzeln transformiert im Markdown. Und die Herausforderung ist jetzt die, wie wir Metadaten aus dem Dokument ziehen k√∂nnen, die im Laufe so eines Dokumentes auftauchen, wie ISBN-Nummern oder Ortsbezeichnungen oder Autoren. Und wie wir diese Informationen danach, diese seitenweise Informationen, in Kapitel transformieren k√∂nnen. Am Ende m√∂chte ich √ºberschaubare Kapitel haben, mit einer Zusammenfassung und entsprechenden Metadaten, die ich dann verwende f√ºr das RAG-System.</p>
<hr />
<p><strong>Cursor</strong></p>
<p>Verstehe! Du willst das bestehende Event/Session-System als <strong>generische Batch-Processing-Pipeline</strong> f√ºr beliebige Dokumenttypen umbauen. Das ist ein sehr durchdachter Ansatz. Lass mich zuerst analysieren, wie der aktuelle SessionManager und EventMonitor funktionieren, um zu verstehen, wie wir sie erweitern k√∂nnen.</p>
<p>Perfekt! Jetzt verstehe ich deine Vision. Das <strong>Event/Session-System ist bereits die ideale Basis</strong> f√ºr das, was du vorhast. Die Architektur ist schon sehr generisch und erweiterbar. Lass mich dir zeigen, wie wir es f√ºr beliebige Dokumenttypen erweitern k√∂nnen:</p>
<h2 id="aktueller-stand-sehr-gut-als-basis-geeignet"><strong>Aktueller Stand (sehr gut als Basis geeignet):</strong><a class="headerlink" href="#aktueller-stand-sehr-gut-als-basis-geeignet" title="Permanent link">&para;</a></h2>
<h3 id="jobbatch-system">‚úÖ <strong>Job/Batch-System</strong><a class="headerlink" href="#jobbatch-system" title="Permanent link">&para;</a></h3>
<ul>
<li><code>EventJobRepository</code> mit MongoDB</li>
<li>Generisches Job-Interface mit <code>job_type</code> und flexiblen <code>parameters</code></li>
<li>Status-Tracking: <code>PENDING</code> ‚Üí <code>PROCESSING</code> ‚Üí <code>COMPLETED</code>/<code>FAILED</code></li>
<li>Batch-Gruppierung f√ºr zusammengeh√∂rige Jobs</li>
</ul>
<h3 id="event-monitor">‚úÖ <strong>Event-Monitor</strong><a class="headerlink" href="#event-monitor" title="Permanent link">&para;</a></h3>
<ul>
<li>Dashboard f√ºr Job-√úberwachung</li>
<li>Batch-Management mit Archivierung</li>
<li>Real-time Status-Updates</li>
</ul>
<h2 id="erweiterungskonzept-fur-pdf-seitenzerteilung"><strong>Erweiterungskonzept f√ºr PDF-Seitenzerteilung:</strong><a class="headerlink" href="#erweiterungskonzept-fur-pdf-seitenzerteilung" title="Permanent link">&para;</a></h2>
<p>Excellent! Du hast recht - das aktuelle Event/Session-System ist eine <strong>perfekte Basis</strong> f√ºr eine generische Dokumentenverarbeitungs-Pipeline. Ich verstehe jetzt deine Vision:</p>
<h2 id="deine-ziel-pipeline">üéØ <strong>Deine Ziel-Pipeline</strong>:<a class="headerlink" href="#deine-ziel-pipeline" title="Permanent link">&para;</a></h2>
<p>PDF ‚Üí Seiten ‚Üí Einzeltransformationen ‚Üí Metadaten-Sammlung ‚Üí Kapitelgruppierung ‚Üí RAG-Index</p>
<h2 id="aktueller-stand-des-eventsession-systems">üìä <strong>Aktueller Stand des Event/Session-Systems</strong><a class="headerlink" href="#aktueller-stand-des-eventsession-systems" title="Permanent link">&para;</a></h2>
<p>Das bestehende System hat bereits eine robuste Infrastruktur:</p>
<h3 id="vorhandene-starken"><strong>‚úÖ Vorhandene St√§rken:</strong><a class="headerlink" href="#vorhandene-starken" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Job-Repository</strong> mit Status-Management (pending/processing/completed/failed)</li>
<li><strong>Batch-System</strong> f√ºr Gruppierung verwandter Jobs  </li>
<li><strong>EventMonitor</strong> f√ºr √úberwachung und Steuerung</li>
<li><strong>API-Routen</strong> f√ºr Job-Management (<code>/api/event-job/batches</code>)</li>
<li><strong>Worker-Integration</strong> (Python-Backend f√ºr Verarbeitung)</li>
<li><strong>MongoDB-Persistierung</strong> mit strukturierten Interfaces</li>
</ul>
<h3 id="erweiterungen-fur-dokument-verarbeitung"><strong>üîÑ Erweiterungen f√ºr Dokument-Verarbeitung:</strong><a class="headerlink" href="#erweiterungen-fur-dokument-verarbeitung" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="kd">enum</span><span class="w"> </span><span class="nx">JobStatus</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">PENDING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;pending&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">PROCESSING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;processing&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">COMPLETED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;completed&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">FAILED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;failed&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">CANCELLED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;cancelled&#39;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">enum</span><span class="w"> </span><span class="nx">AccessVisibility</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">PRIVATE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;private&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">PUBLIC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;public&#39;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">AccessControl</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">visibility</span><span class="o">:</span><span class="w"> </span><span class="kt">AccessVisibility</span><span class="p">;</span>
<span class="w">  </span><span class="nx">read_access</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">write_access</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">admin_access</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">LogEntry</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">level</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;debug&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;info&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;critical&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">JobProgress</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">step</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">percent</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">JobParameters</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Legacy Event/Session fields</span>
<span class="w">  </span><span class="nx">event?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">session?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">url?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">filename?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">track?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">day?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">starttime?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">endtime?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">speakers?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">  </span><span class="nx">video_url?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">attachments_url?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Common processing fields</span>
<span class="w">  </span><span class="nx">source_language</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">target_language</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">use_cache?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Document processing fields</span>
<span class="w">  </span><span class="nx">document_id?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">           </span><span class="c1">// ID des Original-Dokuments</span>
<span class="w">  </span><span class="nx">library_id?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">            </span><span class="c1">// Bibliotheks-ID</span>
<span class="w">  </span><span class="nx">storage_path?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">          </span><span class="c1">// Pfad im Storage-System</span>
<span class="w">  </span><span class="nx">page_number?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w">           </span><span class="c1">// Seitennummer bei Seitentransformation</span>
<span class="w">  </span><span class="nx">total_pages?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w">           </span><span class="c1">// Gesamtanzahl Seiten</span>
<span class="w">  </span><span class="nx">extraction_method?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">     </span><span class="c1">// PDF-Extraktionsmethode</span>
<span class="w">  </span><span class="nx">include_images?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span><span class="w">       </span><span class="c1">// Bilder mit extrahieren</span>

<span class="w">  </span><span class="c1">// Metadaten-Extraktion</span>
<span class="w">  </span><span class="nx">metadata_fields?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span><span class="w">     </span><span class="c1">// Zu extrahierende Metadaten-Felder</span>
<span class="w">  </span><span class="nx">isbn_extract?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span><span class="w">         </span><span class="c1">// ISBN-Nummern extrahieren</span>
<span class="w">  </span><span class="nx">author_extract?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span><span class="w">       </span><span class="c1">// Autoren extrahieren</span>
<span class="w">  </span><span class="nx">location_extract?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span><span class="w">     </span><span class="c1">// Ortsbezeichnungen extrahieren</span>

<span class="w">  </span><span class="c1">// Kapitel-Gruppierung</span>
<span class="w">  </span><span class="nx">chapter_min_pages?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w">     </span><span class="c1">// Minimale Seitenzahl pro Kapitel</span>
<span class="w">  </span><span class="nx">chapter_max_pages?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w">     </span><span class="c1">// Maximale Seitenzahl pro Kapitel</span>
<span class="w">  </span><span class="nx">similarity_threshold?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w">  </span><span class="c1">// √Ñhnlichkeitsschwelle f√ºr Kapitelgruppierung</span>

<span class="w">  </span><span class="c1">// RAG-Integration</span>
<span class="w">  </span><span class="nx">embedding_model?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">       </span><span class="c1">// Verwendetes Embedding-Modell</span>
<span class="w">  </span><span class="nx">chunk_size?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w">           </span><span class="c1">// Chunk-Gr√∂√üe f√ºr RAG</span>
<span class="w">  </span><span class="nx">chunk_overlap?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w">        </span><span class="c1">// √úberlappung zwischen Chunks</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">JobResults</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">markdown_file?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">markdown_content?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">assets?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">web_text?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">video_transcript?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">attachments_text?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">  </span><span class="nx">context?</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">unknown</span><span class="o">&gt;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">  </span><span class="nx">attachments_url?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// Archive-spezifische Felder</span>
<span class="w">  </span><span class="nx">archive_data?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w"> </span><span class="c1">// Base64-kodierte ZIP-Daten</span>
<span class="w">  </span><span class="nx">archive_filename?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w"> </span><span class="c1">// Name der ZIP-Datei</span>
<span class="w">  </span><span class="nx">structured_data?</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">unknown</span><span class="o">&gt;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Strukturierte Session-Daten</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">JobError</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">code</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">details?</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">unknown</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">Job</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">job_id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">job_type</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">job_name?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">event_name?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w"> </span><span class="c1">// üÜï Neues Feld f√ºr Event-Filterung</span>
<span class="w">  </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">JobStatus</span><span class="p">;</span>
<span class="w">  </span><span class="nx">parameters</span><span class="o">:</span><span class="w"> </span><span class="kt">JobParameters</span><span class="p">;</span>
<span class="w">  </span><span class="nx">results?</span><span class="o">:</span><span class="w"> </span><span class="kt">JobResults</span><span class="p">;</span>
<span class="w">  </span><span class="nx">error?</span><span class="o">:</span><span class="w"> </span><span class="kt">JobError</span><span class="p">;</span>
<span class="w">  </span><span class="nx">progress?</span><span class="o">:</span><span class="w"> </span><span class="kt">JobProgress</span><span class="p">;</span>
<span class="w">  </span><span class="nx">created_at</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">updated_at</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">completed_at?</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">started_at?</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">processing_started_at?</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">user_id?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">access_control</span><span class="o">:</span><span class="w"> </span><span class="kt">AccessControl</span><span class="p">;</span>
<span class="w">  </span><span class="nx">event_type?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">batch_id?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">logs?</span><span class="o">:</span><span class="w"> </span><span class="kt">LogEntry</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">archived</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">enum</span><span class="w"> </span><span class="nx">BatchStatus</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">PENDING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;pending&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">RUNNING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;running&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">PAUSED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;paused&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">COMPLETED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;completed&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">FAILED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;failed&#39;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">Batch</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">batch_id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">batch_name?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">event_name?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w"> </span><span class="c1">// üÜï Neues Feld f√ºr Event-Filterung</span>
<span class="w">  </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">BatchStatus</span><span class="p">;</span>
<span class="w">  </span><span class="nx">created_at</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">updated_at</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">completed_at?</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">user_id?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">access_control</span><span class="o">:</span><span class="w"> </span><span class="kt">AccessControl</span><span class="p">;</span>
<span class="w">  </span><span class="nx">total_jobs</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">completed_jobs</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">failed_jobs</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">pending_jobs?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">processing_jobs?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">isActive</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">archived</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">archivedAt?</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">description?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">metadata?</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">unknown</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// API-Anfrage- und Antworttypen</span>
<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">CreateBatchRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">batch_name?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">jobs</span><span class="o">:</span><span class="w"> </span><span class="kt">Array</span><span class="o">&lt;</span><span class="nx">Omit</span><span class="o">&lt;</span><span class="nx">Job</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;job_id&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;created_at&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;updated_at&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;status&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;batch_id&#39;</span><span class="o">&gt;&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">user_id?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">BatchListResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">data</span><span class="o">?:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">batches</span><span class="o">:</span><span class="w"> </span><span class="kt">Batch</span><span class="p">[];</span>
<span class="w">    </span><span class="nx">total</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">limit</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">skip</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="nx">message?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">BatchResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">data</span><span class="o">?:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">batch</span><span class="o">:</span><span class="w"> </span><span class="kt">Batch</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="nx">message?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">JobListResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">data</span><span class="o">?:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">jobs</span><span class="o">:</span><span class="w"> </span><span class="kt">Job</span><span class="p">[];</span>
<span class="w">    </span><span class="nx">total</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">limit</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">skip</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="nx">message?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">JobResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">data</span><span class="o">?:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">job</span><span class="o">:</span><span class="w"> </span><span class="kt">Job</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="nx">message?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">EventJob</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">_id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">batchId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">JobStatus</span><span class="p">;</span>
<span class="w">  </span><span class="nx">createdAt</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">updatedAt</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">startedAt?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">completedAt?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">failedAt?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">lastErrorMessage?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">retryCount</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">maxRetries</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">unknown</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">result?</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">unknown</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">BatchCreatePayload</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">description?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">isActive?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">metadata?</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">unknown</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">JobCreatePayload</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">batchId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">unknown</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">priority?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">maxRetries?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">BatchStats</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">totalJobs</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">pendingJobs</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">runningJobs</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">completedJobs</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">failedJobs</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">cancelledJobs</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">ApiResponse</span><span class="o">&lt;</span><span class="nx">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">unknown</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">data?</span><span class="o">:</span><span class="w"> </span><span class="kt">T</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Event-spezifische Interfaces</span>
<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">EventFilterOptions</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">eventName?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">archived?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">status?</span><span class="o">:</span><span class="w"> </span><span class="kt">BatchStatus</span><span class="p">;</span>
<span class="w">  </span><span class="nx">limit?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">skip?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">isActive?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">EventListResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">data</span><span class="o">?:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">events</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">    </span><span class="nx">total</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="nx">message?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span><span class="w"> </span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">export</span><span class="w"> </span><span class="kd">enum</span><span class="w"> </span><span class="nx">JobStatus</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">PENDING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;pending&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">PROCESSING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;processing&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">COMPLETED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;completed&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">FAILED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;failed&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">CANCELLED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;cancelled&#39;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">enum</span><span class="w"> </span><span class="nx">AccessVisibility</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">PRIVATE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;private&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">PUBLIC</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;public&#39;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">AccessControl</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">visibility</span><span class="o">:</span><span class="w"> </span><span class="kt">AccessVisibility</span><span class="p">;</span>
<span class="w">  </span><span class="nx">read_access</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">write_access</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">admin_access</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">LogEntry</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">timestamp</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">level</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;debug&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;info&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;warning&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;critical&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">JobProgress</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">step</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">percent</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">JobParameters</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Legacy Event/Session fields</span>
<span class="w">  </span><span class="nx">event?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">session?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">url?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">filename?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">track?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">day?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">starttime?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">endtime?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">speakers?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[]</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">  </span><span class="nx">video_url?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">attachments_url?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Common processing fields</span>
<span class="w">  </span><span class="nx">source_language</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">target_language</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">use_cache?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Document processing fields</span>
<span class="w">  </span><span class="nx">document_id?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">           </span><span class="c1">// ID des Original-Dokuments</span>
<span class="w">  </span><span class="nx">library_id?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">            </span><span class="c1">// Bibliotheks-ID</span>
<span class="w">  </span><span class="nx">storage_path?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">          </span><span class="c1">// Pfad im Storage-System</span>
<span class="w">  </span><span class="nx">page_number?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w">           </span><span class="c1">// Seitennummer bei Seitentransformation</span>
<span class="w">  </span><span class="nx">total_pages?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w">           </span><span class="c1">// Gesamtanzahl Seiten</span>
<span class="w">  </span><span class="nx">extraction_method?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">     </span><span class="c1">// PDF-Extraktionsmethode</span>
<span class="w">  </span><span class="nx">include_images?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span><span class="w">       </span><span class="c1">// Bilder mit extrahieren</span>

<span class="w">  </span><span class="c1">// Metadaten-Extraktion</span>
<span class="w">  </span><span class="nx">metadata_fields?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span><span class="w">     </span><span class="c1">// Zu extrahierende Metadaten-Felder</span>
<span class="w">  </span><span class="nx">isbn_extract?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span><span class="w">         </span><span class="c1">// ISBN-Nummern extrahieren</span>
<span class="w">  </span><span class="nx">author_extract?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span><span class="w">       </span><span class="c1">// Autoren extrahieren</span>
<span class="w">  </span><span class="nx">location_extract?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span><span class="w">     </span><span class="c1">// Ortsbezeichnungen extrahieren</span>

<span class="w">  </span><span class="c1">// Kapitel-Gruppierung</span>
<span class="w">  </span><span class="nx">chapter_min_pages?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w">     </span><span class="c1">// Minimale Seitenzahl pro Kapitel</span>
<span class="w">  </span><span class="nx">chapter_max_pages?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w">     </span><span class="c1">// Maximale Seitenzahl pro Kapitel</span>
<span class="w">  </span><span class="nx">similarity_threshold?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w">  </span><span class="c1">// √Ñhnlichkeitsschwelle f√ºr Kapitelgruppierung</span>

<span class="w">  </span><span class="c1">// RAG-Integration</span>
<span class="w">  </span><span class="nx">embedding_model?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">       </span><span class="c1">// Verwendetes Embedding-Modell</span>
<span class="w">  </span><span class="nx">chunk_size?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w">           </span><span class="c1">// Chunk-Gr√∂√üe f√ºr RAG</span>
<span class="w">  </span><span class="nx">chunk_overlap?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w">        </span><span class="c1">// √úberlappung zwischen Chunks</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">JobResults</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="c1">// Legacy Event/Session results</span>
<span class="w">  </span><span class="nx">markdown_file?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">markdown_content?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">assets?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">web_text?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">video_transcript?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">attachments_text?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">  </span><span class="nx">context?</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">unknown</span><span class="o">&gt;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">  </span><span class="nx">attachments_url?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Archive-spezifische Felder</span>
<span class="w">  </span><span class="nx">archive_data?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w"> </span><span class="c1">// Base64-kodierte ZIP-Daten</span>
<span class="w">  </span><span class="nx">archive_filename?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w"> </span><span class="c1">// Name der ZIP-Datei</span>
<span class="w">  </span><span class="nx">structured_data?</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">unknown</span><span class="o">&gt;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Strukturierte Session-Daten</span>

<span class="w">  </span><span class="c1">// Document processing results</span>
<span class="w">  </span><span class="nx">page_content?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">          </span><span class="c1">// Transformierter Seiteninhalt</span>
<span class="w">  </span><span class="nx">page_metadata?</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">unknown</span><span class="o">&gt;</span><span class="p">;</span><span class="w"> </span><span class="c1">// Extrahierte Metadaten der Seite</span>
<span class="w">  </span><span class="nx">extracted_images?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span><span class="w">    </span><span class="c1">// Pfade zu extrahierten Bildern</span>
<span class="w">  </span><span class="nx">document_metadata?</span><span class="o">:</span><span class="w"> </span><span class="kt">DocumentMetadata</span><span class="p">;</span><span class="w"> </span><span class="c1">// Gesammelte Dokument-Metadaten</span>

<span class="w">  </span><span class="c1">// Kapitel-spezifische Ergebnisse</span>
<span class="w">  </span><span class="nx">chapter_title?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">         </span><span class="c1">// Generierter Kapiteltitel</span>
<span class="w">  </span><span class="nx">chapter_summary?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">       </span><span class="c1">// Kapitelzusammenfassung</span>
<span class="w">  </span><span class="nx">chapter_pages?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[];</span><span class="w">       </span><span class="c1">// Seitennummern des Kapitels</span>
<span class="w">  </span><span class="nx">key_concepts?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span><span class="w">        </span><span class="c1">// Schl√ºsselkonzepte des Kapitels</span>

<span class="w">  </span><span class="c1">// RAG-spezifische Ergebnisse</span>
<span class="w">  </span><span class="nx">embeddings?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[][];</span><span class="w">        </span><span class="c1">// Generierte Embeddings</span>
<span class="w">  </span><span class="nx">chunks?</span><span class="o">:</span><span class="w"> </span><span class="kt">RAGChunk</span><span class="p">[];</span><span class="w">           </span><span class="c1">// Erstellte RAG-Chunks</span>
<span class="w">  </span><span class="nx">index_path?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">           </span><span class="c1">// Pfad zum erstellten Index</span>
<span class="p">}</span>

<span class="c1">// Neue Interface-Definitionen f√ºr Document Processing</span>
<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">DocumentMetadata</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">title?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">authors?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">isbn?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">doi?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">publisher?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">publication_date?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">language?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">page_count?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Extrahierte Entit√§ten</span>
<span class="w">  </span><span class="nx">locations?</span><span class="o">:</span><span class="w"> </span><span class="kt">LocationEntity</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">persons?</span><span class="o">:</span><span class="w"> </span><span class="kt">PersonEntity</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">organizations?</span><span class="o">:</span><span class="w"> </span><span class="kt">OrganizationEntity</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">dates?</span><span class="o">:</span><span class="w"> </span><span class="kt">DateEntity</span><span class="p">[];</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">LocationEntity</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">pages</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[];</span><span class="w">              </span><span class="c1">// Seiten auf denen erw√§hnt</span>
<span class="w">  </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w">           </span><span class="c1">// Konfidenz der Extraktion</span>
<span class="w">  </span><span class="nx">coordinates</span><span class="o">?:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">latitude</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">longitude</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">PersonEntity</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">pages</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">role?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">               </span><span class="c1">// z.B. &quot;author&quot;, &quot;researcher&quot;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">OrganizationEntity</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">pages</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="kr">type</span><span class="nx">?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">               </span><span class="c1">// z.B. &quot;university&quot;, &quot;publisher&quot;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">DateEntity</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">date</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">pages</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">confidence</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">context?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">            </span><span class="c1">// Kontext der Datumserw√§hnung</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">RAGChunk</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">page_numbers</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">chapter_id?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">metadata</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">unknown</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">embedding?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[];</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">JobError</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">code</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">details?</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">unknown</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">Job</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">job_id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">job_type</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">job_name?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">event_name?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w"> </span><span class="c1">// üÜï Neues Feld f√ºr Event-Filterung</span>
<span class="w">  </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">JobStatus</span><span class="p">;</span>
<span class="w">  </span><span class="nx">parameters</span><span class="o">:</span><span class="w"> </span><span class="kt">JobParameters</span><span class="p">;</span>
<span class="w">  </span><span class="nx">results?</span><span class="o">:</span><span class="w"> </span><span class="kt">JobResults</span><span class="p">;</span>
<span class="w">  </span><span class="nx">error?</span><span class="o">:</span><span class="w"> </span><span class="kt">JobError</span><span class="p">;</span>
<span class="w">  </span><span class="nx">progress?</span><span class="o">:</span><span class="w"> </span><span class="kt">JobProgress</span><span class="p">;</span>
<span class="w">  </span><span class="nx">created_at</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">updated_at</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">completed_at?</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">started_at?</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">processing_started_at?</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">user_id?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">access_control</span><span class="o">:</span><span class="w"> </span><span class="kt">AccessControl</span><span class="p">;</span>
<span class="w">  </span><span class="nx">event_type?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">batch_id?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">logs?</span><span class="o">:</span><span class="w"> </span><span class="kt">LogEntry</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">archived</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">enum</span><span class="w"> </span><span class="nx">BatchStatus</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">PENDING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;pending&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">RUNNING</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;running&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">PAUSED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;paused&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">COMPLETED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;completed&#39;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">FAILED</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;failed&#39;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">Batch</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">batch_id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">batch_name?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">event_name?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w"> </span><span class="c1">// üÜï Neues Feld f√ºr Event-Filterung</span>
<span class="w">  </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">BatchStatus</span><span class="p">;</span>
<span class="w">  </span><span class="nx">created_at</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">updated_at</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">completed_at?</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">user_id?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">access_control</span><span class="o">:</span><span class="w"> </span><span class="kt">AccessControl</span><span class="p">;</span>
<span class="w">  </span><span class="nx">total_jobs</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">completed_jobs</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">failed_jobs</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">pending_jobs?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">processing_jobs?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">isActive</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">archived</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">archivedAt?</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">description?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">metadata?</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">unknown</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// API-Anfrage- und Antworttypen</span>
<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">CreateBatchRequest</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">batch_name?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">jobs</span><span class="o">:</span><span class="w"> </span><span class="kt">Array</span><span class="o">&lt;</span><span class="nx">Omit</span><span class="o">&lt;</span><span class="nx">Job</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;job_id&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;created_at&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;updated_at&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;status&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;batch_id&#39;</span><span class="o">&gt;&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">user_id?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">BatchListResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">data</span><span class="o">?:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">batches</span><span class="o">:</span><span class="w"> </span><span class="kt">Batch</span><span class="p">[];</span>
<span class="w">    </span><span class="nx">total</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">limit</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">skip</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="nx">message?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">BatchResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">data</span><span class="o">?:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">batch</span><span class="o">:</span><span class="w"> </span><span class="kt">Batch</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="nx">message?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">JobListResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">data</span><span class="o">?:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">jobs</span><span class="o">:</span><span class="w"> </span><span class="kt">Job</span><span class="p">[];</span>
<span class="w">    </span><span class="nx">total</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">limit</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">    </span><span class="nx">skip</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="nx">message?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">JobResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">data</span><span class="o">?:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">job</span><span class="o">:</span><span class="w"> </span><span class="kt">Job</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="nx">message?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">EventJob</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">_id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">batchId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">JobStatus</span><span class="p">;</span>
<span class="w">  </span><span class="nx">createdAt</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">updatedAt</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">startedAt?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">completedAt?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">failedAt?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">lastErrorMessage?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">retryCount</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">maxRetries</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">unknown</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">result?</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">unknown</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">priority</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">BatchCreatePayload</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">name</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">description?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">isActive?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">metadata?</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">unknown</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">JobCreatePayload</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">batchId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">payload</span><span class="o">:</span><span class="w"> </span><span class="kt">Record</span><span class="o">&lt;</span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">unknown</span><span class="o">&gt;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">priority?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">maxRetries?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">BatchStats</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">totalJobs</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">pendingJobs</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">runningJobs</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">completedJobs</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">failedJobs</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">cancelledJobs</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">ApiResponse</span><span class="o">&lt;</span><span class="nx">T</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">unknown</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">data?</span><span class="o">:</span><span class="w"> </span><span class="kt">T</span><span class="p">;</span>
<span class="w">  </span><span class="nx">message?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Event-spezifische Interfaces</span>
<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">EventFilterOptions</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">eventName?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">archived?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">status?</span><span class="o">:</span><span class="w"> </span><span class="kt">BatchStatus</span><span class="p">;</span>
<span class="w">  </span><span class="nx">limit?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">skip?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">isActive?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span><span class="w"> </span><span class="kd">interface</span><span class="w"> </span><span class="nx">EventListResponse</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">data</span><span class="o">?:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">events</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">    </span><span class="nx">total</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="p">};</span>
<span class="w">  </span><span class="nx">message?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="p">}</span><span class="w"> </span>
</code></pre></div>
<p>Excellent! Jetzt habe ich die <strong>Job-Types f√ºr Dokumentverarbeitung</strong> definiert. Lass mich dir zeigen, wie die <strong>generische Pipeline</strong> konkret funktionieren w√ºrde:</p>
<h2 id="neue-job-types-fur-dokumentverarbeitung">üîÑ <strong>Neue Job-Types f√ºr Dokumentverarbeitung:</strong><a class="headerlink" href="#neue-job-types-fur-dokumentverarbeitung" title="Permanent link">&para;</a></h2>
<p><div class="highlight"><pre><span></span><code><span class="gh"># Document Processing Pipeline</span>

<span class="gu">## √úbersicht</span>

Diese Pipeline erweitert das bestehende Event/Session-System um generische Dokumentverarbeitung. Das System zerlegt Dokumente in Seiten, transformiert sie einzeln, extrahiert Metadaten, gruppiert sie zu Kapiteln und erstellt einen RAG-Index.

<span class="gu">## Job-Types f√ºr Dokumentverarbeitung</span>

<span class="gu">### 1. `document-split`</span>
<span class="k">-</span><span class="w"> </span><span class="gs">**Zweck**</span>: PDF in einzelne Seiten aufteilen
<span class="k">-</span><span class="w"> </span><span class="gs">**Input**</span>: Originaldokument (PDF)
<span class="k">-</span><span class="w"> </span><span class="gs">**Output**</span>: Liste von Seiten-Jobs f√ºr nachgelagerte Verarbeitung
<span class="k">-</span><span class="w"> </span><span class="gs">**Parameter**</span>: 
<span class="w">  </span><span class="k">-</span><span class="w"> </span><span class="sb">`document_id`</span>: ID des Originaldokuments
<span class="w">  </span><span class="k">-</span><span class="w"> </span><span class="sb">`extraction_method`</span>: PDF-Extraktionsmethode
<span class="w">  </span><span class="k">-</span><span class="w"> </span><span class="sb">`include_images`</span>: Bilder mit extrahieren

<span class="gu">### 2. `page-transform` </span>
<span class="k">-</span><span class="w"> </span><span class="gs">**Zweck**</span>: Einzelne PDF-Seite in Markdown transformieren
<span class="k">-</span><span class="w"> </span><span class="gs">**Input**</span>: Eine PDF-Seite (Seite X von Y)
<span class="k">-</span><span class="w"> </span><span class="gs">**Output**</span>: Markdown-Content + extrahierte Metadaten
<span class="k">-</span><span class="w"> </span><span class="gs">**Parameter**</span>:
<span class="w">  </span><span class="k">-</span><span class="w"> </span><span class="sb">`page_number`</span>: Seitennummer
<span class="w">  </span><span class="k">-</span><span class="w"> </span><span class="sb">`total_pages`</span>: Gesamtseitenzahl
<span class="w">  </span><span class="k">-</span><span class="w"> </span><span class="sb">`extraction_method`</span>: OCR, native, LLM etc.

<span class="gu">### 3. `metadata-extract`</span>
<span class="k">-</span><span class="w"> </span><span class="gs">**Zweck**</span>: Metadaten aus allen transformierten Seiten sammeln
<span class="k">-</span><span class="w"> </span><span class="gs">**Input**</span>: Alle page-transform Ergebnisse eines Dokuments
<span class="k">-</span><span class="w"> </span><span class="gs">**Output**</span>: Konsolidierte Dokumentmetadaten (ISBN, Autoren, etc.)
<span class="k">-</span><span class="w"> </span><span class="gs">**Parameter**</span>:
<span class="w">  </span><span class="k">-</span><span class="w"> </span><span class="sb">`metadata_fields`</span>: Zu extrahierende Felder
<span class="w">  </span><span class="k">-</span><span class="w"> </span><span class="sb">`isbn_extract`</span>, <span class="sb">`author_extract`</span>, <span class="sb">`location_extract`</span>

<span class="gu">### 4. `chapter-group`</span>
<span class="k">-</span><span class="w"> </span><span class="gs">**Zweck**</span>: Transformierte Seiten zu logischen Kapiteln gruppieren
<span class="k">-</span><span class="w"> </span><span class="gs">**Input**</span>: Alle transformierten Seiten + Metadaten
<span class="k">-</span><span class="w"> </span><span class="gs">**Output**</span>: Kapitel-Definitionen (welche Seiten geh√∂ren zusammen)
<span class="k">-</span><span class="w"> </span><span class="gs">**Parameter**</span>:
<span class="w">  </span><span class="k">-</span><span class="w"> </span><span class="sb">`chapter_min_pages`</span>, <span class="sb">`chapter_max_pages`</span>
<span class="w">  </span><span class="k">-</span><span class="w"> </span><span class="sb">`similarity_threshold`</span>: √Ñhnlichkeitsschwelle

<span class="gu">### 5. `chapter-summarize`</span>
<span class="k">-</span><span class="w"> </span><span class="gs">**Zweck**</span>: Zusammenfassungen f√ºr jedes Kapitel erstellen
<span class="k">-</span><span class="w"> </span><span class="gs">**Input**</span>: Gruppierte Seiten pro Kapitel
<span class="k">-</span><span class="w"> </span><span class="gs">**Output**</span>: Kapitel-Titel, Zusammenfassung, Schl√ºsselkonzepte
<span class="k">-</span><span class="w"> </span><span class="gs">**Parameter**</span>:
<span class="w">  </span><span class="k">-</span><span class="w"> </span><span class="sb">`target_language`</span>: Sprache der Zusammenfassung
<span class="w">  </span><span class="k">-</span><span class="w"> </span><span class="sb">`summary_length`</span>: Gew√ºnschte L√§nge

<span class="gu">### 6. `rag-index`</span>
<span class="k">-</span><span class="w"> </span><span class="gs">**Zweck**</span>: RAG-Index aus Kapitelzusammenfassungen erstellen
<span class="k">-</span><span class="w"> </span><span class="gs">**Input**</span>: Alle Kapitelzusammenfassungen
<span class="k">-</span><span class="w"> </span><span class="gs">**Output**</span>: Vektorindex f√ºr semantische Suche
<span class="k">-</span><span class="w"> </span><span class="gs">**Parameter**</span>:
<span class="w">  </span><span class="k">-</span><span class="w"> </span><span class="sb">`embedding_model`</span>: OpenAI, Cohere, etc.
<span class="w">  </span><span class="k">-</span><span class="w"> </span><span class="sb">`chunk_size`</span>, <span class="sb">`chunk_overlap`</span>

<span class="gu">## Pipeline-Ablauf</span>
</code></pre></div>
PDF-Upload ‚Üí document-split ‚Üí [page-transform] ‚Üí metadata-extract ‚Üí chapter-group ‚Üí [chapter-summarize] ‚Üí rag-index
                                     ‚Üì                                                      ‚Üì
                              Parallel f√ºr alle Seiten                           Parallel f√ºr alle Kapitel
<div class="highlight"><pre><span></span><code>## Beispiel-Batch f√ºr ein 100-Seiten PDF

```typescript
// 1. Document-Split Job
{
  job_type: &quot;document-split&quot;,
  parameters: {
    document_id: &quot;doc-123&quot;,
    library_id: &quot;lib-456&quot;, 
    extraction_method: &quot;native&quot;,
    include_images: true,
    total_pages: 100
  }
}

// 2. Page-Transform Jobs (100 Jobs, einer pro Seite)
{
  job_type: &quot;page-transform&quot;,
  parameters: {
    document_id: &quot;doc-123&quot;,
    page_number: 1,
    total_pages: 100,
    extraction_method: &quot;native&quot;,
    source_language: &quot;de&quot;,
    target_language: &quot;de&quot;
  }
}
// ... Jobs 2-100

// 3. Metadata-Extract Job (sammelt aus allen Seiten)
{
  job_type: &quot;metadata-extract&quot;, 
  parameters: {
    document_id: &quot;doc-123&quot;,
    isbn_extract: true,
    author_extract: true,
    location_extract: true
  }
}

// 4. Chapter-Group Job
{
  job_type: &quot;chapter-group&quot;,
  parameters: {
    document_id: &quot;doc-123&quot;,
    chapter_min_pages: 5,
    chapter_max_pages: 20,
    similarity_threshold: 0.7
  }
}

// 5. Chapter-Summarize Jobs (f√ºr jedes erkannte Kapitel)
{
  job_type: &quot;chapter-summarize&quot;,
  parameters: {
    document_id: &quot;doc-123&quot;, 
    chapter_id: &quot;chap-1&quot;,
    target_language: &quot;de&quot;
  }
}

// 6. RAG-Index Job
{
  job_type: &quot;rag-index&quot;,
  parameters: {
    document_id: &quot;doc-123&quot;,
    embedding_model: &quot;openai&quot;,
    chunk_size: 1000,
    chunk_overlap: 200
  }
}
</code></pre></div></p>
<h2 id="abhangigkeiten-zwischen-jobs">Abh√§ngigkeiten zwischen Jobs<a class="headerlink" href="#abhangigkeiten-zwischen-jobs" title="Permanent link">&para;</a></h2>
<ul>
<li><code>page-transform</code> Jobs k√∂nnen parallel laufen</li>
<li><code>metadata-extract</code> wartet auf alle <code>page-transform</code> Jobs </li>
<li><code>chapter-group</code> wartet auf <code>metadata-extract</code></li>
<li><code>chapter-summarize</code> Jobs k√∂nnen parallel laufen, warten aber auf <code>chapter-group</code></li>
<li><code>rag-index</code> wartet auf alle <code>chapter-summarize</code> Jobs</li>
</ul>
<h2 id="monitoring-und-status">Monitoring und Status<a class="headerlink" href="#monitoring-und-status" title="Permanent link">&para;</a></h2>
<p>Das bestehende EventMonitor-UI zeigt:
- <strong>Fortschritt der Seitentransformation</strong> (z.B. "Seite 34/100 transformiert")
- <strong>Metadaten-Extraktionsstatus</strong> (gefundene ISBN, Autoren etc.)
- <strong>Erkannte Kapitel</strong> (Anzahl und Seitenverteilung)
- <strong>RAG-Index-Status</strong> (Anzahl Chunks, Embeddings etc.)</p>
<h2 id="integration-mit-bestehenden-komponenten">Integration mit bestehenden Komponenten<a class="headerlink" href="#integration-mit-bestehenden-komponenten" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>SessionManager</strong> ‚Üí <strong>DocumentManager</strong> (gleiche UI, andere Datenstruktur)</li>
<li><strong>EventMonitor</strong> ‚Üí erweitert um Document-Jobs</li>
<li><strong>Batch-System</strong> ‚Üí nutzt bestehende Infrastruktur</li>
<li><strong>Job-Repository</strong> ‚Üí erweitert um neue Job-Types
<div class="highlight"><pre><span></span><code>Excellent! Jetzt erstelle ich den **DocumentManager** - eine Komponente, die auf dem SessionManager basiert, aber f√ºr PDF-Dokumentverarbeitung optimiert ist:

```typescriptreact
&#39;use client&#39;;

import { useState, useEffect, useCallback } from &#39;react&#39;;
import { useRouter } from &#39;next/navigation&#39;;
import { Button } from &#39;@/components/ui/button&#39;;
import { Input } from &#39;@/components/ui/input&#39;;
import { Card } from &#39;@/components/ui/card&#39;;
import { Badge } from &#39;@/components/ui/badge&#39;;
import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from &#39;@/components/ui/table&#39;;
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from &#39;@/components/ui/select&#39;;
import {
  Dialog,
  DialogContent,
  DialogHeader,
  DialogTitle,
  DialogDescription,
  DialogFooter
} from &#39;@/components/ui/dialog&#39;;
import { 
  Search, 
  Upload,
  FileText, 
  PlayCircle,
  Loader2,
  RefreshCw,
  Book,
  Eye,
  Settings,
  BarChart3
} from &#39;lucide-react&#39;;
import { useStorage } from &#39;@/hooks/use-storage-provider&#39;;

interface Document {
  id: string;
  filename: string;
  title?: string;
  author?: string;
  pages?: number;
  status: &#39;uploaded&#39; | &#39;processing&#39; | &#39;completed&#39; | &#39;failed&#39;;
  batch_id?: string;
  library_id: string;
  created_at: Date;
  updated_at: Date;

  // Processing Progress
  pages_processed?: number;
  metadata_extracted?: boolean;
  chapters_identified?: number;
  rag_index_created?: boolean;
}

export default function DocumentManagerPage() {
  const [documents, setDocuments] = useState&lt;Document[]&gt;([]);
  const [loading, setLoading] = useState(true);
  const [selectedDocuments, setSelectedDocuments] = useState&lt;Set&lt;string&gt;&gt;(new Set());
  const [searchTerm, setSearchTerm] = useState(&#39;&#39;);
  const [statusFilter, setStatusFilter] = useState&lt;string&gt;(&#39;&#39;);

  // Processing Dialog
  const [processingDialog, setProcessingDialog] = useState(false);
  const [processingSettings, setProcessingSettings] = useState({
    extractionMethod: &#39;native&#39;,
    includeImages: true,
    targetLanguage: &#39;de&#39;,
    chapterMinPages: 5,
    chapterMaxPages: 20,
    similarityThreshold: 0.7,
    embeddingModel: &#39;openai&#39;
  });
  const [processing, setProcessing] = useState(false);

  // Upload Dialog
  const [uploadDialog, setUploadDialog] = useState(false);

  const { provider, currentLibrary } = useStorage();
  const router = useRouter();

  // Dokumente laden
  const loadDocuments = useCallback(async () =&gt; {
    try {
      setLoading(true);

      const params = new URLSearchParams();
      if (searchTerm) params.set(&#39;search&#39;, searchTerm);
      if (statusFilter) params.set(&#39;status&#39;, statusFilter);
      if (currentLibrary?.id) params.set(&#39;library_id&#39;, currentLibrary.id);

      const response = await fetch(`/api/documents?${params.toString()}`);
      const data = await response.json();

      if (data.status === &#39;success&#39;) {
        setDocuments(data.data.documents);
      } else {
        console.error(&#39;Fehler beim Laden der Dokumente:&#39;, data.message);
      }
    } catch (error) {
      console.error(&#39;Fehler beim Laden der Dokumente:&#39;, error);
    } finally {
      setLoading(false);
    }
  }, [searchTerm, statusFilter, currentLibrary?.id]);

  useEffect(() =&gt; {
    if (currentLibrary?.id) {
      loadDocuments();
    }
  }, [loadDocuments, currentLibrary?.id]);

  // Dokument ausw√§hlen/abw√§hlen
  const toggleDocumentSelection = (documentId: string) =&gt; {
    const newSelection = new Set(selectedDocuments);
    if (newSelection.has(documentId)) {
      newSelection.delete(documentId);
    } else {
      newSelection.add(documentId);
    }
    setSelectedDocuments(newSelection);
  };

  // Pipeline f√ºr ausgew√§hlte Dokumente starten
  const startProcessingPipeline = async () =&gt; {
    if (selectedDocuments.size === 0 || !currentLibrary?.id) {
      alert(&#39;Bitte w√§hlen Sie mindestens ein Dokument aus.&#39;);
      return;
    }

    try {
      setProcessing(true);

      // F√ºr jedes ausgew√§hlte Dokument eine Pipeline-Batch erstellen
      for (const documentId of selectedDocuments) {
        const document = documents.find(d =&gt; d.id === documentId);
        if (!document) continue;

        const batchName = `Document Processing: ${document.filename}`;

        // Batch mit Jobs erstellen
        const batchData = {
          batch_name: batchName,
          user_id: &#39;current-user&#39;, // TODO: Von Auth holen
          jobs: [
            // 1. Document-Split Job
            {
              job_name: `Split: ${document.filename}`,
              job_type: &#39;document-split&#39;,
              parameters: {
                document_id: documentId,
                library_id: currentLibrary.id,
                extraction_method: processingSettings.extractionMethod,
                include_images: processingSettings.includeImages,
                source_language: &#39;de&#39;, // TODO: Auto-detect
                target_language: processingSettings.targetLanguage
              }
            },
            // Weitere Jobs werden dynamisch nach document-split erstellt
            {
              job_name: `Metadata: ${document.filename}`,
              job_type: &#39;metadata-extract&#39;,
              parameters: {
                document_id: documentId,
                library_id: currentLibrary.id,
                isbn_extract: true,
                author_extract: true,
                location_extract: true,
                source_language: &#39;de&#39;,
                target_language: processingSettings.targetLanguage
              }
            },
            {
              job_name: `Chapters: ${document.filename}`,
              job_type: &#39;chapter-group&#39;,
              parameters: {
                document_id: documentId,
                library_id: currentLibrary.id,
                chapter_min_pages: processingSettings.chapterMinPages,
                chapter_max_pages: processingSettings.chapterMaxPages,
                similarity_threshold: processingSettings.similarityThreshold,
                source_language: &#39;de&#39;,
                target_language: processingSettings.targetLanguage
              }
            },
            {
              job_name: `RAG Index: ${document.filename}`,
              job_type: &#39;rag-index&#39;,
              parameters: {
                document_id: documentId,
                library_id: currentLibrary.id,
                embedding_model: processingSettings.embeddingModel,
                chunk_size: 1000,
                chunk_overlap: 200,
                source_language: &#39;de&#39;,
                target_language: processingSettings.targetLanguage
              }
            }
          ]
        };

        const response = await fetch(&#39;/api/event-job/batches&#39;, {
          method: &#39;POST&#39;,
          headers: {
            &#39;Content-Type&#39;: &#39;application/json&#39;,
            &#39;X-Library-Id&#39;: currentLibrary.id
          },
          body: JSON.stringify(batchData)
        });

        const result = await response.json();

        if (result.status === &#39;success&#39;) {
          // Dokument-Status aktualisieren
          setDocuments(prev =&gt; prev.map(doc =&gt; 
            doc.id === documentId 
              ? { ...doc, status: &#39;processing&#39;, batch_id: result.data.batch_id }
              : doc
          ));
        } else {
          console.error(`Fehler beim Starten der Pipeline f√ºr ${document.filename}:`, result.message);
        }
      }

      setProcessingDialog(false);
      setSelectedDocuments(new Set());

      // Weiterleitung zum Event Monitor
      router.push(&#39;/event-monitor&#39;);

    } catch (error) {
      console.error(&#39;Fehler beim Starten der Pipeline:&#39;, error);
    } finally {
      setProcessing(false);
    }
  };

  // Status-Badge Komponente
  const StatusBadge = ({ status }: { status: Document[&#39;status&#39;] }) =&gt; {
    const variants = {
      uploaded: &#39;secondary&#39;,
      processing: &#39;default&#39;,
      completed: &#39;success&#39;,
      failed: &#39;destructive&#39;
    } as const;

    const labels = {
      uploaded: &#39;Hochgeladen&#39;,
      processing: &#39;Wird verarbeitet&#39;,
      completed: &#39;Abgeschlossen&#39;,
      failed: &#39;Fehler&#39;
    };

    return (
      &lt;Badge variant={variants[status] as any}&gt;
        {labels[status]}
      &lt;/Badge&gt;
    );
  };

  return (
    &lt;div className=&quot;container py-6&quot;&gt;
      &lt;div className=&quot;flex justify-between items-center mb-6&quot;&gt;
        &lt;div className=&quot;flex items-center gap-4&quot;&gt;
          &lt;h1 className=&quot;text-3xl font-bold flex items-center gap-2&quot;&gt;
            &lt;Book className=&quot;w-8 h-8&quot; /&gt;
            Document Manager
          &lt;/h1&gt;
          {currentLibrary &amp;&amp; (
            &lt;Badge variant=&quot;outline&quot; className=&quot;text-sm&quot;&gt;
              {currentLibrary.name}
            &lt;/Badge&gt;
          )}
        &lt;/div&gt;

        &lt;div className=&quot;flex items-center gap-3&quot;&gt;
          &lt;Button 
            onClick={() =&gt; setProcessingDialog(true)} 
            disabled={selectedDocuments.size === 0}
            className=&quot;bg-primary hover:bg-primary/90&quot;
          &gt;
            &lt;PlayCircle className=&quot;w-4 h-4 mr-2&quot; /&gt;
            Pipeline starten ({selectedDocuments.size})
          &lt;/Button&gt;

          &lt;Button variant=&quot;outline&quot; onClick={loadDocuments} disabled={loading}&gt;
            {loading ? &lt;Loader2 className=&quot;w-4 h-4 animate-spin&quot; /&gt; : &lt;RefreshCw className=&quot;w-4 h-4&quot; /&gt;}
          &lt;/Button&gt;

          &lt;Button variant=&quot;outline&quot; onClick={() =&gt; setUploadDialog(true)}&gt;
            &lt;Upload className=&quot;w-4 h-4 mr-2&quot; /&gt;
            Dokument hochladen
          &lt;/Button&gt;

          &lt;Button 
            variant=&quot;outline&quot;
            onClick={() =&gt; router.push(&#39;/event-monitor&#39;)}
          &gt;
            &lt;BarChart3 className=&quot;w-4 h-4 mr-2&quot; /&gt;
            Event Monitor
          &lt;/Button&gt;
        &lt;/div&gt;
      &lt;/div&gt;

      {/* Filter */}
      &lt;div className=&quot;flex gap-4 mb-6&quot;&gt;
        &lt;div className=&quot;flex-1&quot;&gt;
          &lt;div className=&quot;relative&quot;&gt;
            &lt;Search className=&quot;absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4&quot; /&gt;
            &lt;Input
              placeholder=&quot;Dokumente durchsuchen...&quot;
              value={searchTerm}
              onChange={(e) =&gt; setSearchTerm(e.target.value)}
              className=&quot;pl-10&quot;
            /&gt;
          &lt;/div&gt;
        &lt;/div&gt;

        &lt;Select value={statusFilter} onValueChange={setStatusFilter}&gt;
          &lt;SelectTrigger className=&quot;w-40&quot;&gt;
            &lt;SelectValue placeholder=&quot;Status&quot; /&gt;
          &lt;/SelectTrigger&gt;
          &lt;SelectContent&gt;
            &lt;SelectItem value=&quot;&quot;&gt;Alle Status&lt;/SelectItem&gt;
            &lt;SelectItem value=&quot;uploaded&quot;&gt;Hochgeladen&lt;/SelectItem&gt;
            &lt;SelectItem value=&quot;processing&quot;&gt;Wird verarbeitet&lt;/SelectItem&gt;
            &lt;SelectItem value=&quot;completed&quot;&gt;Abgeschlossen&lt;/SelectItem&gt;
            &lt;SelectItem value=&quot;failed&quot;&gt;Fehler&lt;/SelectItem&gt;
          &lt;/SelectContent&gt;
        &lt;/Select&gt;
      &lt;/div&gt;

      {/* Dokumente Tabelle */}
      &lt;Card&gt;
        &lt;Table&gt;
          &lt;TableHeader&gt;
            &lt;TableRow&gt;
              &lt;TableHead className=&quot;w-12&quot;&gt;
                &lt;input
                  type=&quot;checkbox&quot;
                  checked={selectedDocuments.size === documents.length &amp;&amp; documents.length &gt; 0}
                  onChange={() =&gt; {
                    if (selectedDocuments.size === documents.length) {
                      setSelectedDocuments(new Set());
                    } else {
                      setSelectedDocuments(new Set(documents.map(d =&gt; d.id)));
                    }
                  }}
                /&gt;
              &lt;/TableHead&gt;
              &lt;TableHead&gt;Dokument&lt;/TableHead&gt;
              &lt;TableHead&gt;Status&lt;/TableHead&gt;
              &lt;TableHead&gt;Fortschritt&lt;/TableHead&gt;
              &lt;TableHead&gt;Metadaten&lt;/TableHead&gt;
              &lt;TableHead&gt;Kapitel&lt;/TableHead&gt;
              &lt;TableHead&gt;Aktionen&lt;/TableHead&gt;
            &lt;/TableRow&gt;
          &lt;/TableHeader&gt;
          &lt;TableBody&gt;
            {documents.map((document) =&gt; (
              &lt;TableRow key={document.id}&gt;
                &lt;TableCell&gt;
                  &lt;input
                    type=&quot;checkbox&quot;
                    checked={selectedDocuments.has(document.id)}
                    onChange={() =&gt; toggleDocumentSelection(document.id)}
                  /&gt;
                &lt;/TableCell&gt;
                &lt;TableCell&gt;
                  &lt;div className=&quot;flex flex-col&quot;&gt;
                    &lt;div className=&quot;font-medium flex items-center gap-2&quot;&gt;
                      &lt;FileText className=&quot;w-4 h-4&quot; /&gt;
                      {document.title || document.filename}
                    &lt;/div&gt;
                    {document.author &amp;&amp; (
                      &lt;div className=&quot;text-sm text-gray-500&quot;&gt;von {document.author}&lt;/div&gt;
                    )}
                    {document.pages &amp;&amp; (
                      &lt;div className=&quot;text-sm text-gray-500&quot;&gt;{document.pages} Seiten&lt;/div&gt;
                    )}
                  &lt;/div&gt;
                &lt;/TableCell&gt;
                &lt;TableCell&gt;
                  &lt;StatusBadge status={document.status} /&gt;
                &lt;/TableCell&gt;
                &lt;TableCell&gt;
                  {document.status === &#39;processing&#39; &amp;&amp; (
                    &lt;div className=&quot;text-sm&quot;&gt;
                      {document.pages_processed &amp;&amp; document.pages ? (
                        &lt;div&gt;Seiten: {document.pages_processed}/{document.pages}&lt;/div&gt;
                      ) : (
                        &lt;div&gt;Wird verarbeitet...&lt;/div&gt;
                      )}
                    &lt;/div&gt;
                  )}
                &lt;/TableCell&gt;
                &lt;TableCell&gt;
                  {document.metadata_extracted ? (
                    &lt;Badge variant=&quot;success&quot; className=&quot;text-xs&quot;&gt;Extrahiert&lt;/Badge&gt;
                  ) : (
                    &lt;Badge variant=&quot;secondary&quot; className=&quot;text-xs&quot;&gt;Ausstehend&lt;/Badge&gt;
                  )}
                &lt;/TableCell&gt;
                &lt;TableCell&gt;
                  {document.chapters_identified ? (
                    &lt;div className=&quot;text-sm&quot;&gt;{document.chapters_identified} Kapitel&lt;/div&gt;
                  ) : (
                    &lt;div className=&quot;text-sm text-gray-500&quot;&gt;-&lt;/div&gt;
                  )}
                &lt;/TableCell&gt;
                &lt;TableCell&gt;
                  &lt;div className=&quot;flex gap-2&quot;&gt;
                    &lt;Button variant=&quot;ghost&quot; size=&quot;sm&quot;&gt;
                      &lt;Eye className=&quot;w-4 h-4&quot; /&gt;
                    &lt;/Button&gt;
                    {document.batch_id &amp;&amp; (
                      &lt;Button 
                        variant=&quot;ghost&quot; 
                        size=&quot;sm&quot;
                        onClick={() =&gt; router.push(`/event-monitor/batches/${document.batch_id}`)}
                      &gt;
                        &lt;BarChart3 className=&quot;w-4 h-4&quot; /&gt;
                      &lt;/Button&gt;
                    )}
                  &lt;/div&gt;
                &lt;/TableCell&gt;
              &lt;/TableRow&gt;
            ))}
          &lt;/TableBody&gt;
        &lt;/Table&gt;
      &lt;/Card&gt;

      {/* Processing Dialog */}
      &lt;Dialog open={processingDialog} onOpenChange={setProcessingDialog}&gt;
        &lt;DialogContent className=&quot;max-w-md&quot;&gt;
          &lt;DialogHeader&gt;
            &lt;DialogTitle&gt;Dokumentverarbeitung starten&lt;/DialogTitle&gt;
            &lt;DialogDescription&gt;
              Konfiguriere die Verarbeitungseinstellungen f√ºr {selectedDocuments.size} Dokument(e).
            &lt;/DialogDescription&gt;
          &lt;/DialogHeader&gt;

          &lt;div className=&quot;space-y-4&quot;&gt;
            &lt;div&gt;
              &lt;label className=&quot;text-sm font-medium&quot;&gt;Extraktionsmethode&lt;/label&gt;
              &lt;Select 
                value={processingSettings.extractionMethod} 
                onValueChange={(value) =&gt; setProcessingSettings(prev =&gt; ({ ...prev, extractionMethod: value }))}
              &gt;
                &lt;SelectTrigger&gt;
                  &lt;SelectValue /&gt;
                &lt;/SelectTrigger&gt;
                &lt;SelectContent&gt;
                  &lt;SelectItem value=&quot;native&quot;&gt;Native (schnell)&lt;/SelectItem&gt;
                  &lt;SelectItem value=&quot;ocr&quot;&gt;OCR (f√ºr gescannte PDFs)&lt;/SelectItem&gt;
                  &lt;SelectItem value=&quot;llm&quot;&gt;LLM (beste Qualit√§t)&lt;/SelectItem&gt;
                  &lt;SelectItem value=&quot;both&quot;&gt;Native + OCR&lt;/SelectItem&gt;
                &lt;/SelectContent&gt;
              &lt;/Select&gt;
            &lt;/div&gt;

            &lt;div className=&quot;flex items-center space-x-2&quot;&gt;
              &lt;input
                type=&quot;checkbox&quot;
                id=&quot;includeImages&quot;
                checked={processingSettings.includeImages}
                onChange={(e) =&gt; setProcessingSettings(prev =&gt; ({ ...prev, includeImages: e.target.checked }))}
              /&gt;
              &lt;label htmlFor=&quot;includeImages&quot; className=&quot;text-sm&quot;&gt;Bilder extrahieren&lt;/label&gt;
            &lt;/div&gt;

            &lt;div&gt;
              &lt;label className=&quot;text-sm font-medium&quot;&gt;Kapitel-Einstellungen&lt;/label&gt;
              &lt;div className=&quot;grid grid-cols-2 gap-2 mt-1&quot;&gt;
                &lt;div&gt;
                  &lt;Input
                    type=&quot;number&quot;
                    placeholder=&quot;Min. Seiten&quot;
                    value={processingSettings.chapterMinPages}
                    onChange={(e) =&gt; setProcessingSettings(prev =&gt; ({ ...prev, chapterMinPages: parseInt(e.target.value) }))}
                  /&gt;
                &lt;/div&gt;
                &lt;div&gt;
                  &lt;Input
                    type=&quot;number&quot;
                    placeholder=&quot;Max. Seiten&quot;
                    value={processingSettings.chapterMaxPages}
                    onChange={(e) =&gt; setProcessingSettings(prev =&gt; ({ ...prev, chapterMaxPages: parseInt(e.target.value) }))}
                  /&gt;
                &lt;/div&gt;
              &lt;/div&gt;
            &lt;/div&gt;
          &lt;/div&gt;

          &lt;DialogFooter&gt;
            &lt;Button variant=&quot;outline&quot; onClick={() =&gt; setProcessingDialog(false)}&gt;
              Abbrechen
            &lt;/Button&gt;
            &lt;Button onClick={startProcessingPipeline} disabled={processing}&gt;
              {processing ? &lt;Loader2 className=&quot;w-4 h-4 animate-spin mr-2&quot; /&gt; : null}
              Pipeline starten
            &lt;/Button&gt;
          &lt;/DialogFooter&gt;
        &lt;/DialogContent&gt;
      &lt;/Dialog&gt;
    &lt;/div&gt;
  );
}
</code></pre></div></li>
</ul>
<div class="highlight"><pre><span></span><code><span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">NextRequest</span><span class="p">,</span><span class="w"> </span><span class="nx">NextResponse</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;next/server&#39;</span><span class="p">;</span>
<span class="k">import</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">auth</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="kr">from</span><span class="w"> </span><span class="s1">&#39;@clerk/nextjs/server&#39;</span><span class="p">;</span>

<span class="c1">// Dummy-Interface f√ºr die Documents (sp√§ter durch echte DB ersetzen)</span>
<span class="kd">interface</span><span class="w"> </span><span class="nx">Document</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">filename</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">title?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">author?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">pages?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;uploaded&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;processing&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;completed&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;failed&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">batch_id?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">library_id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">created_at</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">updated_at</span><span class="o">:</span><span class="w"> </span><span class="kt">Date</span><span class="p">;</span>
<span class="w">  </span><span class="nx">pages_processed?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">metadata_extracted?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="nx">chapters_identified?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="w">  </span><span class="nx">rag_index_created?</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * GET /api/documents</span>
<span class="cm"> * Holt alle Dokumente f√ºr die aktuelle Bibliothek</span>
<span class="cm"> */</span>
<span class="k">export</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">GET</span><span class="p">(</span><span class="nx">request</span><span class="o">:</span><span class="w"> </span><span class="kt">NextRequest</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Authentifizierung pr√ºfen</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">userId</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">auth</span><span class="p">();</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">userId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">NextResponse</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span>
<span class="w">          </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Nicht authentifiziert&#39;</span><span class="w"> </span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">401</span><span class="w"> </span><span class="p">}</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">searchParams</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">URL</span><span class="p">(</span><span class="nx">request</span><span class="p">.</span><span class="nx">url</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">search</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">searchParams</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;search&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">searchParams</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;status&#39;</span><span class="p">);</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">libraryId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">searchParams</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;library_id&#39;</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">libraryId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">NextResponse</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span>
<span class="w">          </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Library ID erforderlich&#39;</span><span class="w"> </span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">400</span><span class="w"> </span><span class="p">}</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// TODO: Echte Datenbankabfrage implementieren</span>
<span class="w">    </span><span class="c1">// Momentan Dummy-Daten f√ºr Demonstration</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">mockDocuments</span><span class="o">:</span><span class="w"> </span><span class="kt">Document</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;doc-1&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">filename</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;√ñkosysteme_der_Nordsee.pdf&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;√ñkosysteme der Nordsee&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">author</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Dr. Maria Schmidt&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">pages</span><span class="o">:</span><span class="w"> </span><span class="kt">342</span><span class="p">,</span>
<span class="w">        </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;completed&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">library_id</span><span class="o">:</span><span class="w"> </span><span class="kt">libraryId</span><span class="p">,</span>
<span class="w">        </span><span class="nx">created_at</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="s1">&#39;2024-01-15&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="nx">updated_at</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="s1">&#39;2024-01-20&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="nx">pages_processed</span><span class="o">:</span><span class="w"> </span><span class="kt">342</span><span class="p">,</span>
<span class="w">        </span><span class="nx">metadata_extracted</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
<span class="w">        </span><span class="nx">chapters_identified</span><span class="o">:</span><span class="w"> </span><span class="kt">12</span><span class="p">,</span>
<span class="w">        </span><span class="nx">rag_index_created</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
<span class="w">        </span><span class="nx">batch_id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;batch-123&#39;</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;doc-2&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="nx">filename</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Biodiversit√§t_im_Wandel.pdf&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Biodiversit√§t im Wandel&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">author</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Prof. Hans Meyer&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">pages</span><span class="o">:</span><span class="w"> </span><span class="kt">156</span><span class="p">,</span>
<span class="w">        </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;processing&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">library_id</span><span class="o">:</span><span class="w"> </span><span class="kt">libraryId</span><span class="p">,</span>
<span class="w">        </span><span class="nx">created_at</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="s1">&#39;2024-01-18&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="nx">updated_at</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="s1">&#39;2024-01-19&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="nx">pages_processed</span><span class="o">:</span><span class="w"> </span><span class="kt">89</span><span class="p">,</span>
<span class="w">        </span><span class="nx">metadata_extracted</span><span class="o">:</span><span class="w"> </span><span class="kt">false</span><span class="p">,</span>
<span class="w">        </span><span class="nx">chapters_identified</span><span class="o">:</span><span class="w"> </span><span class="kt">0</span><span class="p">,</span>
<span class="w">        </span><span class="nx">batch_id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;batch-124&#39;</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">        </span><span class="nx">id</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;doc-3&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">filename</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Klimawandel_Auswirkungen.pdf&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Klimawandel und seine Auswirkungen&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">pages</span><span class="o">:</span><span class="w"> </span><span class="kt">278</span><span class="p">,</span>
<span class="w">        </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;uploaded&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">library_id</span><span class="o">:</span><span class="w"> </span><span class="kt">libraryId</span><span class="p">,</span>
<span class="w">        </span><span class="nx">created_at</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="s1">&#39;2024-01-19&#39;</span><span class="p">),</span>
<span class="w">        </span><span class="nx">updated_at</span><span class="o">:</span><span class="w"> </span><span class="kt">new</span><span class="w"> </span><span class="nb">Date</span><span class="p">(</span><span class="s1">&#39;2024-01-19&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">];</span>

<span class="w">    </span><span class="c1">// Filter anwenden</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">filteredDocuments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">mockDocuments</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">doc</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">doc</span><span class="p">.</span><span class="nx">library_id</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">libraryId</span><span class="p">);</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">search</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">searchLower</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">search</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>
<span class="w">      </span><span class="nx">filteredDocuments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">filteredDocuments</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">doc</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span>
<span class="w">        </span><span class="nx">doc</span><span class="p">.</span><span class="nx">filename</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">includes</span><span class="p">(</span><span class="nx">searchLower</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
<span class="w">        </span><span class="nx">doc</span><span class="p">.</span><span class="nx">title</span><span class="o">?</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">includes</span><span class="p">(</span><span class="nx">searchLower</span><span class="p">)</span><span class="w"> </span><span class="o">||</span>
<span class="w">        </span><span class="nx">doc</span><span class="p">.</span><span class="nx">author</span><span class="o">?</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">().</span><span class="nx">includes</span><span class="p">(</span><span class="nx">searchLower</span><span class="p">)</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">status</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">filteredDocuments</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">filteredDocuments</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">doc</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">doc</span><span class="p">.</span><span class="nx">status</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">status</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">NextResponse</span><span class="p">.</span><span class="nx">json</span><span class="p">({</span>
<span class="w">      </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;success&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">data</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nx">documents</span><span class="o">:</span><span class="w"> </span><span class="kt">filteredDocuments</span><span class="p">,</span>
<span class="w">        </span><span class="nx">count</span><span class="o">:</span><span class="w"> </span><span class="kt">filteredDocuments.length</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">});</span>
<span class="w">  </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="nx">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="s1">&#39;[API] Fehler beim Abrufen der Dokumente:&#39;</span><span class="p">,</span><span class="w"> </span><span class="nx">error</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">NextResponse</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span>
<span class="w">      </span><span class="p">{</span><span class="w"> </span>
<span class="w">        </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Interner Serverfehler&#39;</span><span class="p">,</span>
<span class="w">        </span><span class="nx">error</span><span class="o">:</span><span class="w"> </span><span class="kt">error</span><span class="w"> </span><span class="ow">instanceof</span><span class="w"> </span><span class="ne">Error</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="nx">error</span><span class="p">.</span><span class="nx">message</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Unbekannter Fehler&#39;</span>
<span class="w">      </span><span class="p">},</span>
<span class="w">      </span><span class="p">{</span><span class="w"> </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">500</span><span class="w"> </span><span class="p">}</span>
<span class="w">    </span><span class="p">);</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>

<span class="cm">/**</span>
<span class="cm"> * POST /api/documents</span>
<span class="cm"> * Erstellt ein neues Dokument (Upload)</span>
<span class="cm"> */</span>
<span class="k">export</span><span class="w"> </span><span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">POST</span><span class="p">(</span><span class="nx">request</span><span class="o">:</span><span class="w"> </span><span class="kt">NextRequest</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// Authentifizierung pr√ºfen</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">userId</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">auth</span><span class="p">();</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">userId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">NextResponse</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span>
<span class="w">          </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Nicht authentifiziert&#39;</span><span class="w"> </span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">401</span><span class="w"> </span><span class="p">}</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">formData</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">request</span><span class="p">.</span><span class="nx">formData</span><span class="p">();</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">formData</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">)</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="nx">File</span><span class="p">;</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">libraryId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">formData</span><span class="p">.</span><span class="nx">get</span><span class="p">(</span><span class="s1">&#39;library_id&#39;</span><span class="p">)</span><span class="w"> </span><span class="kr">as</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">file</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="o">!</span><span class="nx">libraryId</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nx">NextResponse</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span>
<span class="w">          </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;error&#39;</span><span class="p">,</span>
<span class="w">          </span><span class="nx">message</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;Datei und Library ID erforderlich&#39;</span><span class="w"> </span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nx">status</span><span class="o">:</span><span class="w"> </span><span class="kt">400</span><span class="w"> </span><span class="p">}</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// TODO: Echte Datei-Upload-Logik implementieren</span>
<span class="w">    </span><span class="c1">// - Datei im Storage speichern</span>
<span class="w">    </span><span class="c1">// - Dokument in Datenbank anlegen</span>
<span class="w">    </span><span class="c1">// - Erste Metadaten ext</span>
</code></pre></div>
<hr />
<p><strong>User</strong></p>
<p>Bevor wir anfangen yu Programmieren, m;chte ich noch weiter konyipieren. Hier einige √úberlegungen. K√∂nnen wir zuerst einen Plan kreiren und diesen dokumentieren?
Das ist ein super wichtiger und ehrlicher Einwurf! Tats√§chlich ist gerade der Sprung von einer schnellen, seitenbasierten PDF-Transformation zu einem generischen, robusten System, das Dokumente unterschiedlicher Formate und Granularit√§ten sauber verarbeitet, eine der zentralen Herausforderungen.</p>
<p>Zentrale Herausforderungen und was wirklich zu tun ist:
1. Modularisierung &amp; Generifizierung des Processing-Stacks
Bisher: SessionManager/EventMonitor sind stark auf ein spezielles Event-Format ausgelegt.</p>
<p>Ziel:</p>
<p>Modularisieren: Baue die Pipeline so um, dass sie beliebige Formate verarbeiten kann (Audio, Video, PDF, Text etc.).</p>
<p>Generifizierung: Mache die Verarbeitung (z.‚ÄØB. Seiten-, Kapitel-, oder Zeitachsenbasiert) √ºber Konfiguration oder Plugins steuerbar.</p>
<p>Empfehlung:</p>
<p>Definiere ein generisches Datenmodell f√ºr "DocumentChunk" (egal ob Seite, Kapitel, Zeitabschnitt).</p>
<p>Implementiere "Importer" f√ºr verschiedene Formate, die alle in dieses Chunk-Modell transformieren.</p>
<p>Halte den Rest der Pipeline (Transformation, Metadaten-Extraktion, Storage) davon unabh√§ngig.</p>
<ol>
<li>Metadaten-Extraktion verbessern
Bisher: Metadaten werden seitenweise, meist aus PDF-Metadaten oder Einzelseiten extrahiert.</li>
</ol>
<p>Ziel:</p>
<p>Semantische Extraktion: Entwickle eine Pipeline, die laufend Metadaten sammelt und erkennt, wann sie sich im Dokument √§ndern (z.‚ÄØB. wenn ein neuer Autor/Kapitel/Ort erw√§hnt wird).</p>
<p>Zusammenf√ºhren: Weise Metadaten intelligent den passenden Kapiteln/Chunks zu.</p>
<p>Empfehlung:</p>
<p>Implementiere eine "Metadaten-Aggregation", die erkennt, ob eine Info ein "Dokumenten-Metadatum" (global) oder ein "Kapitel-/Abschnittsmetadatum" (lokal) ist.</p>
<p>Nutze Named-Entity-Recognition (NER) f√ºr Felder wie Personen, Orte, ISBN etc.</p>
<ol>
<li>Chunking &amp; Kapitelbildung
Bisher: Sequentielle Seitenverarbeitung, oft ohne logische Kapitelbildung.</li>
</ol>
<p>Ziel:</p>
<p>Logische Chunks/Kapitel bilden:
Erkenne im Stream der Seiten die Struktur (Kapitel√ºberschriften, Section Breaks, Pattern Matching).</p>
<p>Zusammenfassen: Fasse Seiten zu Kapiteln zusammen, extrahiere daraus eine Kapitelzusammenfassung und die zugeh√∂rigen Metadaten.</p>
<p>Empfehlung:</p>
<p>Entwickle ein "Kapitel-Erkennungsmodul" (z.‚ÄØB. Regex auf √úberschriften, ToC-Matching, AI-gest√ºtzt bei komplexen Dokumenten).</p>
<p>Jede Chunk/Kapitel erh√§lt:</p>
<p>Den Flie√ütext (Markdown)</p>
<p>Ein Set von Metadaten</p>
<p>Eine generierte Zusammenfassung</p>
<ol>
<li>Mass Processing &amp; Skalierbarkeit
Bisher: Verarbeitung gro√üer Mengen ist m√∂glich, aber nicht optimiert und wenig generisch.</li>
</ol>
<p>Ziel:</p>
<p>Batch Processing:
Baue den Batch- und EventMonitor so um, dass beliebige Import-Jobs (verschiedene Formate/Quellen) verarbeitet werden k√∂nnen.</p>
<p>Monitoring/Logging:
Baue ein gutes Monitoring f√ºr Processing-Status, Fehler und Ausnahmen ein.</p>
<p>Empfehlung:</p>
<p>Verwende eine Queue-basierte Verarbeitung (z.‚ÄØB. mit BullMQ/Redis oder Node-Worker Threads), um gro√üe Mengen asynchron zu handeln.</p>
<p>Logge f√ºr jedes Chunk/Job die Ergebnisse und Fehler im zentralen Dashboard/EventMonitor.</p>
<ol>
<li>Vorbereiten f√ºr RAG
Ziel:</li>
</ol>
<p>Jedes Chunk/Kapitel ist nachher so aufgebaut, dass es mit Embeddings versehen und f√ºr Retrieval genutzt werden kann (RAG = Retrieval Augmented Generation).</p>
<p>Metadaten werden als Filter im RAG nutzbar (z.‚ÄØB. nur Kapitel aus bestimmten Jahren, Autoren, Themen).</p>
<p>Deine n√§chsten Schritte ‚Äì konkret, auf deinen Bedarf angepasst:
Datenmodell f√ºr generische DocumentChunks/Kapitel designen
(Basis: Text, Metadaten, Zusammenfassung, Link zum Original)</p>
<p>Importer f√ºr verschiedene Formate anlegen
(PDF, Audio, Video ‚Üí alles wird auf DocumentChunks gemappt)</p>
<p>Pipeline f√ºr Metadaten-Extraktion &amp; Kapitelbildung verbessern</p>
<p>Globale vs. lokale Metadaten sauber trennen</p>
<p>Named-Entity-Recognition als Zwischenschritt einbauen</p>
<p>Batch- und EventMonitor refactoren</p>
<p>Generisches Processing, Logging, Fehlerhandling</p>
<p>Dashboard/Statusansicht f√ºr gro√üe Importe</p>
<p>RAG-Readiness sicherstellen</p>
<p>Saubere Chunks/Kapitel mit Metadaten und Summaries ausgeben</p>
<p>Embeddings vorbereiten/testen</p>
<hr />
<p><strong>Cursor</strong></p>
<p>Absolut richtig! <strong>Du hast eine exzellente Analyse gemacht</strong> - das zeigt, dass du aus Erfahrung wei√üt, wie wichtig solide Konzeption vor der Implementierung ist. Deine f√ºnf identifizierten Herausforderungen treffen den Kern des Problems.</p>
<p>Lass uns einen <strong>strukturierten Plan</strong> erstellen und dokumentieren, bevor wir auch nur eine Zeile Code schreiben.</p>
<p>Perfekt! <strong>Du hast die Herausforderung sehr analytisch durchdacht.</strong> Deine f√ºnf identifizierten Punkte sind exakt die Knackpunkte. Lass uns einen <strong>strukturierten Konzeptionsplan</strong> erstellen:</p>
<h2 id="kernproblem-analyse">üéØ <strong>Kernproblem-Analyse</strong><a class="headerlink" href="#kernproblem-analyse" title="Permanent link">&para;</a></h2>
<p>Du hast v√∂llig recht: Das aktuelle Event/Session-System ist zu <strong>format-spezifisch</strong> und <strong>nicht generisch genug</strong>. Wir brauchen eine <strong>Architektur-Transformation</strong>, nicht nur Feature-Erweiterungen.</p>
<h2 id="konzeptionsplan-generischer-processing-stack">üìã <strong>Konzeptionsplan: Generischer Processing-Stack</strong><a class="headerlink" href="#konzeptionsplan-generischer-processing-stack" title="Permanent link">&para;</a></h2>
<h3 id="1-zentrales-datenmodell-documentchunk"><strong>1. Zentrales Datenmodell: DocumentChunk</strong><a class="headerlink" href="#1-zentrales-datenmodell-documentchunk" title="Permanent link">&para;</a></h3>
<p><strong>Das Herzst√ºck</strong>: Ein universeller <code>DocumentChunk</code> - egal ob PDF-Seite, Audio-Segment oder Video-Kapitel:</p>
<div class="highlight"><pre><span></span><code><span class="kd">interface</span><span class="w"> </span><span class="nx">DocumentChunk</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">chunk_id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">document_id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">sequence_number</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w">        </span><span class="c1">// Position im Dokument</span>

<span class="w">  </span><span class="c1">// Content (format-agnostisch)</span>
<span class="w">  </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">                </span><span class="c1">// Transformierter Text (Markdown)</span>
<span class="w">  </span><span class="nx">content_type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;text&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;audio_transcript&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;image_description&#39;</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Position (format-spezifisch)</span>
<span class="w">  </span><span class="nx">position</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">page_number?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w">         </span><span class="c1">// PDF</span>
<span class="w">    </span><span class="nx">time_start?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w">          </span><span class="c1">// Audio/Video</span>
<span class="w">    </span><span class="nx">section_path?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span><span class="w">      </span><span class="c1">// Hierarchie</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="c1">// Metadaten (2-Level)</span>
<span class="w">  </span><span class="nx">local_metadata</span><span class="o">:</span><span class="w"> </span><span class="kt">ChunkMetadata</span><span class="p">;</span><span class="w">  </span><span class="c1">// Nur f√ºr diesen Chunk</span>
<span class="w">  </span><span class="nx">inherited_metadata</span><span class="o">:</span><span class="w"> </span><span class="kt">DocumentMetadata</span><span class="p">;</span><span class="w"> </span><span class="c1">// Vom Dokument</span>

<span class="w">  </span><span class="c1">// RAG-Readiness</span>
<span class="w">  </span><span class="nx">embeddings?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">summary?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">confidence_score</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="2-format-agnostische-import-pipeline"><strong>2. Format-Agnostische Import-Pipeline</strong><a class="headerlink" href="#2-format-agnostische-import-pipeline" title="Permanent link">&para;</a></h3>
<p><strong>Modularer Ansatz</strong> mit Importer-Pattern:</p>
<div class="highlight"><pre><span></span><code><span class="kd">interface</span><span class="w"> </span><span class="nx">FormatImporter</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">format</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">canHandle</span><span class="p">(</span><span class="nx">file</span><span class="o">:</span><span class="w"> </span><span class="kt">File</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="k">import</span><span class="p">(</span><span class="nx">file</span><span class="o">:</span><span class="w"> </span><span class="kt">File</span><span class="p">,</span><span class="w"> </span><span class="nx">strategy</span><span class="o">:</span><span class="w"> </span><span class="kt">ChunkingStrategy</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">DocumentChunk</span><span class="p">[]</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Konkrete Implementierungen:</span>
<span class="c1">// - PDFImporter (page-based oder semantic-based)</span>
<span class="c1">// - AudioImporter (time-based mit Transkription)</span>
<span class="c1">// - VideoImporter (kombiniert Audio + Frame-Analysis)</span>
<span class="c1">// - TextImporter (paragraph oder semantic-based)</span>
</code></pre></div>
<h3 id="3-intelligente-metadaten-pipeline"><strong>3. Intelligente Metadaten-Pipeline</strong><a class="headerlink" href="#3-intelligente-metadaten-pipeline" title="Permanent link">&para;</a></h3>
<p><strong>Zwei-Ebenen-Ansatz</strong> (deine Kern-Insight):</p>
<div class="highlight"><pre><span></span><code><span class="c1">// GLOBAL: Document-weite Metadaten (ISBN, Hauptautoren, etc.)</span>
<span class="kd">interface</span><span class="w"> </span><span class="nx">DocumentMetadata</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">authors</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">isbn?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">publication_date?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// ... wird EINMAL pro Dokument extrahiert</span>
<span class="p">}</span>

<span class="c1">// LOKAL: Chunk-spezifische Metadaten </span>
<span class="kd">interface</span><span class="w"> </span><span class="nx">ChunkMetadata</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">mentioned_persons</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span><span class="w">    </span><span class="c1">// Nur in diesem Chunk erw√§hnt</span>
<span class="w">  </span><span class="nx">mentioned_locations</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">section_type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;intro&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;methods&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;results&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">local_topics</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">  </span><span class="c1">// ... wird PER CHUNK extrahiert</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="4-kapitel-erkennung-multi-strategy"><strong>4. Kapitel-Erkennung (Multi-Strategy)</strong><a class="headerlink" href="#4-kapitel-erkennung-multi-strategy" title="Permanent link">&para;</a></h3>
<p><strong>Hybrid-Ansatz</strong> f√ºr robuste Kapitelbildung:</p>
<div class="highlight"><pre><span></span><code><span class="kd">interface</span><span class="w"> </span><span class="nx">ChapterDetector</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">detectChapters</span><span class="p">(</span><span class="nx">chunks</span><span class="o">:</span><span class="w"> </span><span class="kt">DocumentChunk</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Chapter</span><span class="p">[]</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 1. StructuralDetector: Pattern-based (√úberschriften, Seitenzahlen)</span>
<span class="c1">// 2. SemanticDetector: Content-based (Topic-Shifts, Similarity)</span>
<span class="c1">// 3. HybridDetector: Kombiniert beide Strategien</span>
</code></pre></div>
<h3 id="5-rag-optimierte-chapter-summaries"><strong>5. RAG-Optimierte Chapter-Summaries</strong><a class="headerlink" href="#5-rag-optimierte-chapter-summaries" title="Permanent link">&para;</a></h3>
<p><strong>Jedes Kapitel wird RAG-ready</strong> aufbereitet:</p>
<div class="highlight"><pre><span></span><code><span class="kd">interface</span><span class="w"> </span><span class="nx">Chapter</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">chapter_id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">chunk_ids</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>

<span class="w">  </span><span class="c1">// RAG-Optimiert</span>
<span class="w">  </span><span class="nx">summary</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">              </span><span class="c1">// F√ºr LLM-Kontext</span>
<span class="w">  </span><span class="nx">key_concepts</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span><span class="w">       </span><span class="c1">// F√ºr Keyword-Search</span>
<span class="w">  </span><span class="nx">search_embeddings</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[];</span><span class="w">  </span><span class="c1">// F√ºr Semantic-Search</span>

<span class="w">  </span><span class="c1">// Filterable Metadata</span>
<span class="w">  </span><span class="nx">time_period?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">main_location?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">primary_authors?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="5-phasen-implementierungs-roadmap">üó∫Ô∏è <strong>5-Phasen Implementierungs-Roadmap</strong><a class="headerlink" href="#5-phasen-implementierungs-roadmap" title="Permanent link">&para;</a></h2>
<h3 id="phase-1-fundament-woche-1-2"><strong>Phase 1: Fundament (Woche 1-2)</strong><a class="headerlink" href="#phase-1-fundament-woche-1-2" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>DocumentChunk</strong> Datenmodell implementieren</li>
<li><strong>FormatImporter</strong> Interface + PDFImporter (erweitert bestehende Transformation)</li>
<li><strong>Job-System</strong> f√ºr neue Job-Types erweitern</li>
<li><strong>MongoDB Schema</strong> f√ºr Chunks/Documents</li>
</ul>
<h3 id="phase-2-metadaten-intelligence-woche-3-4"><strong>Phase 2: Metadaten-Intelligence (Woche 3-4)</strong><a class="headerlink" href="#phase-2-metadaten-intelligence-woche-3-4" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Zwei-Ebenen Metadaten-Extraktion</strong> (global vs. lokal)</li>
<li><strong>Named Entity Recognition</strong> f√ºr Personen/Orte/Konzepte</li>
<li><strong>Chapter Detection</strong> (strukturell + semantisch)</li>
<li><strong>Confidence Scoring</strong> f√ºr alle Extraktionen</li>
</ul>
<h3 id="phase-3-ui-monitoring-woche-5"><strong>Phase 3: UI &amp; Monitoring (Woche 5)</strong><a class="headerlink" href="#phase-3-ui-monitoring-woche-5" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>DocumentManager</strong> (basierend auf SessionManager)</li>
<li><strong>EventMonitor Erweiterung</strong> f√ºr Document-Processing</li>
<li><strong>Progress-Tracking</strong> f√ºr mehrstufige Pipeline</li>
<li><strong>Quality Dashboard</strong> mit Confidence-Metriken</li>
</ul>
<h3 id="phase-4-rag-integration-woche-6-7"><strong>Phase 4: RAG-Integration (Woche 6-7)</strong><a class="headerlink" href="#phase-4-rag-integration-woche-6-7" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Chapter-Summarization</strong> mit LLM</li>
<li><strong>Embedding-Generation</strong> f√ºr semantische Suche</li>
<li><strong>RAG-Index</strong> mit Metadaten-Filtern</li>
<li><strong>Chat-Interface Prototyp</strong> f√ºr Testing</li>
</ul>
<h3 id="phase-5-skalierung-woche-8"><strong>Phase 5: Skalierung (Woche 8)</strong><a class="headerlink" href="#phase-5-skalierung-woche-8" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Batch-Processing</strong> f√ºr gro√üe Dokumentmengen</li>
<li><strong>Performance-Optimierung</strong> (Parallel Processing)</li>
<li><strong>Quality Assurance</strong> und Error-Recovery</li>
<li><strong>Integration mit bestehendem Biodiv-Korpus</strong></li>
</ul>
<h2 id="kritische-erfolgskriterien">üéØ <strong>Kritische Erfolgskriterien</strong><a class="headerlink" href="#kritische-erfolgskriterien" title="Permanent link">&para;</a></h2>
<h3 id="quantitative-ziele"><strong>Quantitative Ziele:</strong><a class="headerlink" href="#quantitative-ziele" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Speed</strong>: &lt; 2 Minuten pro 100 PDF-Seiten</li>
<li><strong>Quality</strong>: &gt; 85% korrekte Kapitel-Erkennung</li>
<li><strong>Accuracy</strong>: &gt; 90% Metadaten-Extraktion (ISBN/Autor)</li>
<li><strong>Scalability</strong>: 1000+ Dokumente ohne Performance-Degradation</li>
</ul>
<h3 id="qualitative-ziele"><strong>Qualitative Ziele:</strong><a class="headerlink" href="#qualitative-ziele" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Generizit√§t</strong>: Neues Format in &lt; 1 Tag integrierbar</li>
<li><strong>Transparency</strong>: Jeder Processing-Schritt nachvollziehbar</li>
<li><strong>User-Friendly</strong>: Non-technical User kann gro√üe Batches verarbeiten</li>
</ul>
<h2 id="risiko-mitigation">üöß <strong>Risiko-Mitigation</strong><a class="headerlink" href="#risiko-mitigation" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Over-Engineering</strong>: MVP-First, iterative Erweiterung</li>
<li><strong>Chunking-Qualit√§t</strong>: Mehrere Strategien + Human-Validation Option</li>
<li><strong>Format Edge-Cases</strong>: Modulare Importer + Fallback-Mechanismen</li>
</ol>
<h2 id="kritische-designentscheidungen-die-wir-klaren-sollten">ü§î <strong>Kritische Designentscheidungen, die wir kl√§ren sollten:</strong><a class="headerlink" href="#kritische-designentscheidungen-die-wir-klaren-sollten" title="Permanent link">&para;</a></h2>
<ol>
<li><strong>Chunking-Granularit√§t</strong>: Seiten-basiert vs. semantisch vs. hybrid?</li>
<li><strong>Metadaten-Priorit√§t</strong>: Welche Entit√§ten sind kritisch f√ºr deinen Biodiv-Korpus?</li>
<li><strong>Chapter-Definition</strong>: Wie intelligent soll die automatische Kapitelbildung sein?</li>
<li><strong>Quality vs. Speed</strong>: Wo ist der Sweet-Spot f√ºr deine Anwendung?</li>
</ol>
<p><strong>Sollen wir als n√§chstes</strong> mit einem <strong>Minimal-Prototyp</strong> des DocumentChunk-Modells anfangen und das mit einem echten Biodiv-PDF testen? Das w√ºrde uns schnell zeigen, ob das Konzept tr√§gt.</p>
<div class="highlight"><pre><span></span><code><span class="kd">interface</span><span class="w"> </span><span class="nx">DocumentChunk</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">chunk_id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">document_id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">sequence_number</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w">        </span><span class="c1">// Position im Dokument</span>

<span class="w">  </span><span class="c1">// Content (format-agnostisch)</span>
<span class="w">  </span><span class="nx">content</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">                </span><span class="c1">// Transformierter Text (Markdown)</span>
<span class="w">  </span><span class="nx">content_type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;text&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;audio_transcript&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;image_description&#39;</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Position (format-spezifisch)</span>
<span class="w">  </span><span class="nx">position</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">page_number?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w">         </span><span class="c1">// PDF</span>
<span class="w">    </span><span class="nx">time_start?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span><span class="w">          </span><span class="c1">// Audio/Video</span>
<span class="w">    </span><span class="nx">section_path?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span><span class="w">      </span><span class="c1">// Hierarchie</span>
<span class="w">  </span><span class="p">};</span>

<span class="w">  </span><span class="c1">// Metadaten (2-Level)</span>
<span class="w">  </span><span class="nx">local_metadata</span><span class="o">:</span><span class="w"> </span><span class="kt">ChunkMetadata</span><span class="p">;</span><span class="w">  </span><span class="c1">// Nur f√ºr diesen Chunk</span>
<span class="w">  </span><span class="nx">inherited_metadata</span><span class="o">:</span><span class="w"> </span><span class="kt">DocumentMetadata</span><span class="p">;</span><span class="w"> </span><span class="c1">// Vom Dokument</span>

<span class="w">  </span><span class="c1">// RAG-Readiness</span>
<span class="w">  </span><span class="nx">embeddings?</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">summary?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">confidence_score</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kd">interface</span><span class="w"> </span><span class="nx">FormatImporter</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">format</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">canHandle</span><span class="p">(</span><span class="nx">file</span><span class="o">:</span><span class="w"> </span><span class="kt">File</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">boolean</span><span class="p">;</span>
<span class="w">  </span><span class="k">import</span><span class="p">(</span><span class="nx">file</span><span class="o">:</span><span class="w"> </span><span class="kt">File</span><span class="p">,</span><span class="w"> </span><span class="nx">strategy</span><span class="o">:</span><span class="w"> </span><span class="kt">ChunkingStrategy</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">DocumentChunk</span><span class="p">[]</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// Konkrete Implementierungen:</span>
<span class="c1">// - PDFImporter (page-based oder semantic-based)</span>
<span class="c1">// - AudioImporter (time-based mit Transkription)</span>
<span class="c1">// - VideoImporter (kombiniert Audio + Frame-Analysis)</span>
<span class="c1">// - TextImporter (paragraph oder semantic-based)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">// GLOBAL: Document-weite Metadaten (ISBN, Hauptautoren, etc.)</span>
<span class="kd">interface</span><span class="w"> </span><span class="nx">DocumentMetadata</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">authors</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">isbn?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">publication_date?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="c1">// ... wird EINMAL pro Dokument extrahiert</span>
<span class="p">}</span>

<span class="c1">// LOKAL: Chunk-spezifische Metadaten </span>
<span class="kd">interface</span><span class="w"> </span><span class="nx">ChunkMetadata</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">mentioned_persons</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span><span class="w">    </span><span class="c1">// Nur in diesem Chunk erw√§hnt</span>
<span class="w">  </span><span class="nx">mentioned_locations</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">  </span><span class="nx">section_type</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;intro&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;methods&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;results&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">local_topics</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">  </span><span class="c1">// ... wird PER CHUNK extrahiert</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kd">interface</span><span class="w"> </span><span class="nx">ChapterDetector</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">detectChapters</span><span class="p">(</span><span class="nx">chunks</span><span class="o">:</span><span class="w"> </span><span class="kt">DocumentChunk</span><span class="p">[])</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="nx">Chapter</span><span class="p">[]</span><span class="o">&gt;</span><span class="p">;</span>
<span class="p">}</span>

<span class="c1">// 1. StructuralDetector: Pattern-based (√úberschriften, Seitenzahlen)</span>
<span class="c1">// 2. SemanticDetector: Content-based (Topic-Shifts, Similarity)</span>
<span class="c1">// 3. HybridDetector: Kombiniert beide Strategien</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kd">interface</span><span class="w"> </span><span class="nx">Chapter</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">chapter_id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">title</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">chunk_ids</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>

<span class="w">  </span><span class="c1">// RAG-Optimiert</span>
<span class="w">  </span><span class="nx">summary</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">              </span><span class="c1">// F√ºr LLM-Kontext</span>
<span class="w">  </span><span class="nx">key_concepts</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span><span class="w">       </span><span class="c1">// F√ºr Keyword-Search</span>
<span class="w">  </span><span class="nx">search_embeddings</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[];</span><span class="w">  </span><span class="c1">// F√ºr Semantic-Search</span>

<span class="w">  </span><span class="c1">// Filterable Metadata</span>
<span class="w">  </span><span class="nx">time_period?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">main_location?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">primary_authors?</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="p">}</span>
</code></pre></div>
<hr />
<p><strong>User</strong></p>
<p>Zun√§chst muss ich auch √ºberlegen, ein Prototyp ist sicher gut. Ich muss aber auch √ºberlegen, welcher Teil dieser Aufgabe innerhalb des Secretary Service stattfindet. Es ist ja das Backend in Python programmiert. Und hier der Knowledge Scout ist ja das Frontend, das nur die Organisation der Dateien und Filesysteme, User Interface, bereitstellt. Deswegen wird diese Logik hier wahrscheinlich in dem anderen Projekt, in dem Secretary Service, programmiert werden m√ºssen. Und von den Prototypen w√ºrde ich gerne folgendes machen, dass ich ein PDF seitenweise transkriminiere. Und dann f√ºr jede Seite die Metadaten abfragen, die dort vorkommen. Und dann das gesamte generierte Markdown-File mit den Metadaten, dort wird auch wahrscheinlich irgendwo ein Inhaltsverzeichnis vorkommen, an das Large Language Modell senden,Und nochmal die Kapitel-Gliederung Opfer mit Hinweis Seiten welcher Seite welches Kapitel beginnt und dann mit diesen globalen Metadaten es m√ºsste es richtig extrahieren also zuerst seitenweise und in einem zweiten Schritt das gesamte Dokument mit den Zusammenfassungen der einzelnen Kapitel mit der Kapitel-Gliederung und der Zusammenfassung der einzelnen Kapitel</p>
<hr />
<p><strong>Cursor</strong></p>
<p><strong>Absolut richtig!</strong> Das ist eine wichtige <strong>Architektur-Kl√§rung</strong>. Du hast recht - die <strong>Processing-Logik geh√∂rt in den Secretary Service</strong> (Python), nicht in den Knowledge Scout (Next.js Frontend).</p>
<p>Lass mich die <strong>Architektur-Verteilung</strong> und deinen <strong>zweistufigen Prototyp-Ansatz</strong> strukturieren:</p>
<p>Perfect! Jetzt verstehe ich die <strong>Architektur-Verteilung</strong> besser. Du hast absolut recht:</p>
<h2 id="architektur-verteilung">üèóÔ∏è <strong>Architektur-Verteilung</strong><a class="headerlink" href="#architektur-verteilung" title="Permanent link">&para;</a></h2>
<h3 id="knowledge-scout-nextjs-frontend"><strong>Knowledge Scout (Next.js Frontend)</strong><a class="headerlink" href="#knowledge-scout-nextjs-frontend" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Rolle</strong>: Datei-Organisation, UI, Bibliotheksverwaltung  </li>
<li><strong>Aktuell</strong>: Ruft Secretary Service √ºber <code>/api/secretary/process-pdf</code> auf</li>
<li><strong>Neue Aufgaben</strong>: Job-Orchestrierung, Progress-Monitoring, Ergebnis-Speicherung</li>
</ul>
<h3 id="secretary-service-python-backend"><strong>Secretary Service (Python Backend)</strong><a class="headerlink" href="#secretary-service-python-backend" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Rolle</strong>: Eigentliche Dokumentverarbeitung, AI/LLM-Integration</li>
<li><strong>Aktuell</strong>: <code>/pdf/process</code> mit verschiedenen <code>extraction_method</code></li>
<li><strong>Neue Aufgaben</strong>: Seitenweise Verarbeitung, Metadaten-Extraktion, Kapitel-Analyse</li>
</ul>
<h2 id="dein-zweistufiger-prototyp-plan">üìã <strong>Dein Zweistufiger Prototyp-Plan</strong><a class="headerlink" href="#dein-zweistufiger-prototyp-plan" title="Permanent link">&para;</a></h2>
<p>Das ist ein <strong>sehr pragmatischer Ansatz</strong>! Lass mich das strukturieren:</p>
<h3 id="stufe-1-seitenweise-verarbeitung-secretary-service"><strong>Stufe 1: Seitenweise Verarbeitung</strong> (Secretary Service)<a class="headerlink" href="#stufe-1-seitenweise-verarbeitung-secretary-service" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Neuer Endpoint: /pdf/process-pagewise</span>
<span class="mf">1.</span> <span class="n">PDF</span> <span class="ow">in</span> <span class="n">einzelne</span> <span class="n">Seiten</span> <span class="n">aufteilen</span>
<span class="mf">2.</span> <span class="n">Jede</span> <span class="n">Seite</span> <span class="err">‚Üí</span> <span class="n">Markdown</span> <span class="n">transformieren</span>  
<span class="mf">3.</span> <span class="n">Pro</span> <span class="n">Seite</span> <span class="err">‚Üí</span> <span class="n">Metadaten</span> <span class="n">extrahieren</span> <span class="p">(</span><span class="n">Personen</span><span class="p">,</span> <span class="n">Orte</span><span class="p">,</span> <span class="n">Konzepte</span><span class="p">)</span>
<span class="mf">4.</span> <span class="n">Return</span><span class="p">:</span> <span class="n">Liste</span> <span class="n">von</span> <span class="n">Seiten</span> <span class="n">mit</span> <span class="n">jeweiligen</span> <span class="n">Metadaten</span>
</code></pre></div>
<h3 id="stufe-2-globale-kapitel-analyse-secretary-service"><strong>Stufe 2: Globale Kapitel-Analyse</strong> (Secretary Service)<a class="headerlink" href="#stufe-2-globale-kapitel-analyse-secretary-service" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Neuer Endpoint: /pdf/analyze-chapters</span>
<span class="n">Input</span><span class="p">:</span> <span class="n">Alle</span> <span class="n">Seiten</span><span class="o">-</span><span class="n">Markdowns</span> <span class="o">+</span> <span class="n">Metadaten</span>
<span class="mf">1.</span> <span class="n">Gesamtes</span> <span class="n">Dokument</span> <span class="n">an</span> <span class="n">LLM</span> <span class="n">senden</span>
<span class="mf">2.</span> <span class="n">LLM</span> <span class="err">‚Üí</span> <span class="n">Kapitel</span><span class="o">-</span><span class="n">Gliederung</span> <span class="n">mit</span> <span class="n">Seitenzuordnung</span>  
<span class="mf">3.</span> <span class="n">LLM</span> <span class="err">‚Üí</span> <span class="n">Zusammenfassung</span> <span class="n">pro</span> <span class="n">Kapitel</span>
<span class="mf">4.</span> <span class="n">Return</span><span class="p">:</span> <span class="n">Strukturiertes</span> <span class="n">Kapitel</span><span class="o">-</span><span class="n">Dokument</span>
</code></pre></div>
<h2 id="prototyp-workflow">üîÑ <strong>Prototyp-Workflow</strong><a class="headerlink" href="#prototyp-workflow" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="c1"># Neuer Endpoint: /pdf/process-pagewise</span>
<span class="mf">1.</span> <span class="n">PDF</span> <span class="ow">in</span> <span class="n">einzelne</span> <span class="n">Seiten</span> <span class="n">aufteilen</span>
<span class="mf">2.</span> <span class="n">Jede</span> <span class="n">Seite</span> <span class="err">‚Üí</span> <span class="n">Markdown</span> <span class="n">transformieren</span>  
<span class="mf">3.</span> <span class="n">Pro</span> <span class="n">Seite</span> <span class="err">‚Üí</span> <span class="n">Metadaten</span> <span class="n">extrahieren</span> <span class="p">(</span><span class="n">Personen</span><span class="p">,</span> <span class="n">Orte</span><span class="p">,</span> <span class="n">Konzepte</span><span class="p">)</span>
<span class="mf">4.</span> <span class="n">Return</span><span class="p">:</span> <span class="n">Liste</span> <span class="n">von</span> <span class="n">Seiten</span> <span class="n">mit</span> <span class="n">jeweiligen</span> <span class="n">Metadaten</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Neuer Endpoint: /pdf/analyze-chapters</span>
<span class="n">Input</span><span class="p">:</span> <span class="n">Alle</span> <span class="n">Seiten</span><span class="o">-</span><span class="n">Markdowns</span> <span class="o">+</span> <span class="n">Metadaten</span>
<span class="mf">1.</span> <span class="n">Gesamtes</span> <span class="n">Dokument</span> <span class="n">an</span> <span class="n">LLM</span> <span class="n">senden</span>
<span class="mf">2.</span> <span class="n">LLM</span> <span class="err">‚Üí</span> <span class="n">Kapitel</span><span class="o">-</span><span class="n">Gliederung</span> <span class="n">mit</span> <span class="n">Seitenzuordnung</span>  
<span class="mf">3.</span> <span class="n">LLM</span> <span class="err">‚Üí</span> <span class="n">Zusammenfassung</span> <span class="n">pro</span> <span class="n">Kapitel</span>
<span class="mf">4.</span> <span class="n">Return</span><span class="p">:</span> <span class="n">Strukturiertes</span> <span class="n">Kapitel</span><span class="o">-</span><span class="n">Dokument</span>
</code></pre></div>
<pre class="mermaid"><code>sequenceDiagram
    participant User
    participant KS as Knowledge Scout
    participant SS as Secretary Service
    participant LLM

    User-&gt;&gt;KS: PDF hochladen + "Erweiterte Analyse" starten

    Note over KS: Job-Batch erstellen
    KS-&gt;&gt;SS: POST /pdf/process-pagewise
    Note right of SS: PDF ‚Üí Einzelseiten&lt;br/&gt;Seite 1 ‚Üí Markdown + Metadaten&lt;br/&gt;Seite 2 ‚Üí Markdown + Metadaten&lt;br/&gt;...&lt;br/&gt;Seite N ‚Üí Markdown + Metadaten
    SS--&gt;&gt;KS: Seiten-Array mit Metadaten

    Note over KS: Speichere Seiten-Ergebnisse

    KS-&gt;&gt;SS: POST /pdf/analyze-chapters (alle Seiten)
    SS-&gt;&gt;LLM: Gesamtes Dokument + "Erstelle Kapitel-Gliederung"
    LLM--&gt;&gt;SS: Kapitel mit Seitenzuordnung
    SS-&gt;&gt;LLM: Pro Kapitel + "Erstelle Zusammenfassung"  
    LLM--&gt;&gt;SS: Kapitel-Zusammenfassungen
    SS--&gt;&gt;KS: Strukturiertes Dokument mit Kapiteln

    Note over KS: Speichere finales Ergebnis als Shadow Twin
    KS--&gt;&gt;User: Kapitel-√úbersicht anzeigen</code></pre>
<h2 id="konkreter-implementierungsplan">üõ†Ô∏è <strong>Konkreter Implementierungsplan</strong><a class="headerlink" href="#konkreter-implementierungsplan" title="Permanent link">&para;</a></h2>
<h3 id="phase-1-secretary-service-erweitern"><strong>Phase 1: Secretary Service erweitern</strong><a class="headerlink" href="#phase-1-secretary-service-erweitern" title="Permanent link">&para;</a></h3>
<h4 id="neuer-endpoint-pdfprocess-pagewise"><strong>Neuer Endpoint</strong>: <code>/pdf/process-pagewise</code><a class="headerlink" href="#neuer-endpoint-pdfprocess-pagewise" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/pdf/process-pagewise&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">process_pdf_pagewise</span><span class="p">():</span>
    <span class="c1"># 1. PDF in Seiten aufteilen (PyPDF2 oder similar)</span>
    <span class="c1"># 2. Pro Seite:</span>
    <span class="c1">#    - Text extrahieren (native/OCR je nach extractionMethod)</span>
    <span class="c1">#    - Markdown generieren  </span>
    <span class="c1">#    - Metadaten extrahieren (NER f√ºr Personen, Orte, etc.)</span>
    <span class="c1">#    - Bilder extrahieren (falls includeImages=true)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pages&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;page_number&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;markdown_content&quot;</span><span class="p">:</span> <span class="s2">&quot;# Seite 1 Inhalt...&quot;</span><span class="p">,</span>
                <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;persons&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Dr. Schmidt&quot;</span><span class="p">,</span> <span class="s2">&quot;Prof. Meyer&quot;</span><span class="p">],</span> 
                    <span class="s2">&quot;locations&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Berlin&quot;</span><span class="p">,</span> <span class="s2">&quot;Nordsee&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;concepts&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Biodiversit√§t&quot;</span><span class="p">,</span> <span class="s2">&quot;√ñkosystem&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;dates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2023-05-15&quot;</span><span class="p">]</span>
                <span class="p">},</span>
                <span class="s2">&quot;images&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;page1_img1.png&quot;</span><span class="p">,</span> <span class="s2">&quot;page1_img2.png&quot;</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="c1"># ... weitere Seiten</span>
        <span class="p">],</span>
        <span class="s2">&quot;total_pages&quot;</span><span class="p">:</span> <span class="mi">42</span>
    <span class="p">}</span>
</code></pre></div>
<h4 id="neuer-endpoint-pdfanalyze-chapters"><strong>Neuer Endpoint</strong>: <code>/pdf/analyze-chapters</code><a class="headerlink" href="#neuer-endpoint-pdfanalyze-chapters" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/pdf/analyze-chapters&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">analyze_chapters</span><span class="p">():</span>
    <span class="n">pages_data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;pages&#39;</span><span class="p">]</span>

    <span class="c1"># 1. Alle Seiten zu einem Gesamt-Markdown zusammenf√ºgen</span>
    <span class="n">full_document</span> <span class="o">=</span> <span class="n">combine_pages_to_document</span><span class="p">(</span><span class="n">pages_data</span><span class="p">)</span>

    <span class="c1"># 2. LLM-Prompt f√ºr Kapitel-Erkennung</span>
    <span class="n">chapter_prompt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Analysiere dieses Dokument und erstelle eine Kapitel-Gliederung:</span>

<span class="s2">    </span><span class="si">{</span><span class="n">full_document</span><span class="si">}</span>

<span class="s2">    Erstelle eine JSON-Struktur mit:</span>
<span class="s2">    - Kapitel-Titel</span>
<span class="s2">    - Seiten-Range (von Seite X bis Seite Y)  </span>
<span class="s2">    - Kurze Kapitel-Beschreibung</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="n">chapters</span> <span class="o">=</span> <span class="n">llm_call</span><span class="p">(</span><span class="n">chapter_prompt</span><span class="p">)</span>

    <span class="c1"># 3. Pro Kapitel eine Zusammenfassung erstellen</span>
    <span class="k">for</span> <span class="n">chapter</span> <span class="ow">in</span> <span class="n">chapters</span><span class="p">:</span>
        <span class="n">chapter_content</span> <span class="o">=</span> <span class="n">extract_chapter_content</span><span class="p">(</span><span class="n">pages_data</span><span class="p">,</span> <span class="n">chapter</span><span class="p">[</span><span class="s1">&#39;page_range&#39;</span><span class="p">])</span>
        <span class="n">summary_prompt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Erstelle eine Zusammenfassung f√ºr: </span><span class="si">{</span><span class="n">chapter_content</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">chapter</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">llm_call</span><span class="p">(</span><span class="n">summary_prompt</span><span class="p">)</span>
        <span class="n">chapter</span><span class="p">[</span><span class="s1">&#39;key_concepts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">extract_key_concepts</span><span class="p">(</span><span class="n">chapter_content</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;document_title&quot;</span><span class="p">:</span> <span class="s2">&quot;Auto-generiert aus Inhalt&quot;</span><span class="p">,</span>
        <span class="s2">&quot;total_pages&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">pages_data</span><span class="p">),</span>
        <span class="s2">&quot;chapters&quot;</span><span class="p">:</span> <span class="n">chapters</span><span class="p">,</span>
        <span class="s2">&quot;global_metadata&quot;</span><span class="p">:</span> <span class="n">extract_global_metadata</span><span class="p">(</span><span class="n">pages_data</span><span class="p">)</span>
    <span class="p">}</span>
</code></pre></div>
<h3 id="phase-2-knowledge-scout-orchestrierung"><strong>Phase 2: Knowledge Scout Orchestrierung</strong><a class="headerlink" href="#phase-2-knowledge-scout-orchestrierung" title="Permanent link">&para;</a></h3>
<h4 id="neuer-job-typ-pdf_advanced_analysis"><strong>Neuer Job-Typ</strong>: <code>pdf_advanced_analysis</code><a class="headerlink" href="#neuer-job-typ-pdf_advanced_analysis" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">// In existing Job-System</span>
<span class="p">{</span>
<span class="w">  </span><span class="nx">job_type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;pdf_advanced_analysis&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">parameters</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">document_id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;doc-123&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">library_id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;lib-456&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">extraction_method</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;native&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// oder &quot;ocr&quot;, &quot;llm&quot; </span>
<span class="w">    </span><span class="nx">include_images</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
<span class="w">    </span><span class="nx">target_language</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;de&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="erweiterte-orchestrierung"><strong>Erweiterte Orchestrierung</strong>:<a class="headerlink" href="#erweiterte-orchestrierung" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nx">AdvancedPdfProcessor</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">processDocument</span><span class="p">(</span><span class="nx">file</span><span class="o">:</span><span class="w"> </span><span class="kt">File</span><span class="p">,</span><span class="w"> </span><span class="nx">libraryId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 1. Stufe 1: Seitenweise Verarbeitung</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">pagesResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/api/secretary/process-pdf-pagewise&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="kt">formData</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="c1">// 2. Zwischenspeicherung f√ºr Debugging</span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">storePageResults</span><span class="p">(</span><span class="nx">pagesResult</span><span class="p">.</span><span class="nx">pages</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 3. Stufe 2: Kapitel-Analyse</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">chaptersResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/api/secretary/analyze-chapters&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">      </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">({</span><span class="w"> </span><span class="nx">pages</span><span class="o">:</span><span class="w"> </span><span class="kt">pagesResult.pages</span><span class="w"> </span><span class="p">})</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="c1">// 4. Finales Shadow Twin erstellen</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">finalMarkdown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">generateStructuredMarkdown</span><span class="p">(</span><span class="nx">chaptersResult</span><span class="p">);</span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">storeShadowTwin</span><span class="p">(</span><span class="nx">finalMarkdown</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">batch_id</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="prototyp-test-mit-echtem-biodiv-pdf">üß™ <strong>Prototyp-Test mit echtem Biodiv-PDF</strong><a class="headerlink" href="#prototyp-test-mit-echtem-biodiv-pdf" title="Permanent link">&para;</a></h2>
<h3 id="test-szenario"><strong>Test-Szenario</strong>:<a class="headerlink" href="#test-szenario" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Input</strong>: Ein 30-50 Seiten Biodiversit√§ts-PDF</li>
<li><strong>Erwartung Stufe 1</strong>: </li>
<li>Jede Seite als sauberes Markdown</li>
<li>Extrahierte Arten-Namen, Orte, Forscher pro Seite</li>
<li><strong>Erwartung Stufe 2</strong>:</li>
<li>3-5 erkannte Kapitel (Einleitung, Methoden, Ergebnisse, etc.)</li>
<li>Sinnvolle Seitenzuordnung </li>
<li>Kapitel-Zusammenfassungen mit Kernaussagen</li>
</ol>
<h3 id="success-metrics"><strong>Success Metrics</strong>:<a class="headerlink" href="#success-metrics" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Textqualit√§t</strong>: &gt; 95% korrekte Textextraktion</li>
<li><strong>Metadaten-Accuracy</strong>: &gt; 80% richtig erkannte Entit√§ten  </li>
<li><strong>Kapitel-Erkennung</strong>: Logische Gliederung, nachvollziehbar</li>
<li><strong>Performance</strong>: &lt; 5 Minuten f√ºr 50-Seiten PDF</li>
</ul>
<h2 id="nachste-schritte-entscheidung">‚ùì <strong>N√§chste Schritte - Entscheidung</strong><a class="headerlink" href="#nachste-schritte-entscheidung" title="Permanent link">&para;</a></h2>
<p><strong>Option A</strong>: Erst Secretary Service Endpoints entwickeln, dann testen
<strong>Option B</strong>: Bestehende PDF-Transformation erweitern f√ºr seitenweise Verarbeitung<br />
<strong>Option C</strong>: Mini-Prototyp mit einem 5-Seiten Test-PDF</p>
<p><strong>Was denkst du?</strong> Sollen wir mit <strong>Option C</strong> (Mini-Prototyp) anfangen, um das Konzept schnell zu validieren? Oder direkt die neuen Endpoints im Secretary Service implementieren?</p>
<div class="highlight"><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/pdf/process-pagewise&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">process_pdf_pagewise</span><span class="p">():</span>
    <span class="c1"># 1. PDF in Seiten aufteilen (PyPDF2 oder similar)</span>
    <span class="c1"># 2. Pro Seite:</span>
    <span class="c1">#    - Text extrahieren (native/OCR je nach extractionMethod)</span>
    <span class="c1">#    - Markdown generieren  </span>
    <span class="c1">#    - Metadaten extrahieren (NER f√ºr Personen, Orte, etc.)</span>
    <span class="c1">#    - Bilder extrahieren (falls includeImages=true)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
        <span class="s2">&quot;pages&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="s2">&quot;page_number&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="s2">&quot;markdown_content&quot;</span><span class="p">:</span> <span class="s2">&quot;# Seite 1 Inhalt...&quot;</span><span class="p">,</span>
                <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;persons&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Dr. Schmidt&quot;</span><span class="p">,</span> <span class="s2">&quot;Prof. Meyer&quot;</span><span class="p">],</span> 
                    <span class="s2">&quot;locations&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Berlin&quot;</span><span class="p">,</span> <span class="s2">&quot;Nordsee&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;concepts&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Biodiversit√§t&quot;</span><span class="p">,</span> <span class="s2">&quot;√ñkosystem&quot;</span><span class="p">],</span>
                    <span class="s2">&quot;dates&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;2023-05-15&quot;</span><span class="p">]</span>
                <span class="p">},</span>
                <span class="s2">&quot;images&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;page1_img1.png&quot;</span><span class="p">,</span> <span class="s2">&quot;page1_img2.png&quot;</span><span class="p">]</span>
            <span class="p">},</span>
            <span class="c1"># ... weitere Seiten</span>
        <span class="p">],</span>
        <span class="s2">&quot;total_pages&quot;</span><span class="p">:</span> <span class="mi">42</span>
    <span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/pdf/analyze-chapters&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">analyze_chapters</span><span class="p">():</span>
    <span class="n">pages_data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;pages&#39;</span><span class="p">]</span>

    <span class="c1"># 1. Alle Seiten zu einem Gesamt-Markdown zusammenf√ºgen</span>
    <span class="n">full_document</span> <span class="o">=</span> <span class="n">combine_pages_to_document</span><span class="p">(</span><span class="n">pages_data</span><span class="p">)</span>

    <span class="c1"># 2. LLM-Prompt f√ºr Kapitel-Erkennung</span>
    <span class="n">chapter_prompt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Analysiere dieses Dokument und erstelle eine Kapitel-Gliederung:</span>

<span class="s2">    </span><span class="si">{</span><span class="n">full_document</span><span class="si">}</span>

<span class="s2">    Erstelle eine JSON-Struktur mit:</span>
<span class="s2">    - Kapitel-Titel</span>
<span class="s2">    - Seiten-Range (von Seite X bis Seite Y)  </span>
<span class="s2">    - Kurze Kapitel-Beschreibung</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="n">chapters</span> <span class="o">=</span> <span class="n">llm_call</span><span class="p">(</span><span class="n">chapter_prompt</span><span class="p">)</span>

    <span class="c1"># 3. Pro Kapitel eine Zusammenfassung erstellen</span>
    <span class="k">for</span> <span class="n">chapter</span> <span class="ow">in</span> <span class="n">chapters</span><span class="p">:</span>
        <span class="n">chapter_content</span> <span class="o">=</span> <span class="n">extract_chapter_content</span><span class="p">(</span><span class="n">pages_data</span><span class="p">,</span> <span class="n">chapter</span><span class="p">[</span><span class="s1">&#39;page_range&#39;</span><span class="p">])</span>
        <span class="n">summary_prompt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Erstelle eine Zusammenfassung f√ºr: </span><span class="si">{</span><span class="n">chapter_content</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">chapter</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">llm_call</span><span class="p">(</span><span class="n">summary_prompt</span><span class="p">)</span>
        <span class="n">chapter</span><span class="p">[</span><span class="s1">&#39;key_concepts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">extract_key_concepts</span><span class="p">(</span><span class="n">chapter_content</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;document_title&quot;</span><span class="p">:</span> <span class="s2">&quot;Auto-generiert aus Inhalt&quot;</span><span class="p">,</span>
        <span class="s2">&quot;total_pages&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">pages_data</span><span class="p">),</span>
        <span class="s2">&quot;chapters&quot;</span><span class="p">:</span> <span class="n">chapters</span><span class="p">,</span>
        <span class="s2">&quot;global_metadata&quot;</span><span class="p">:</span> <span class="n">extract_global_metadata</span><span class="p">(</span><span class="n">pages_data</span><span class="p">)</span>
    <span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code>## üõ†Ô∏è **Konkreter Implementierungsplan**

### **Phase 1: Secretary Service erweitern**

#### **Neuer Endpoint**: `/pdf/process-pagewise`
```python
@app.route(&#39;/pdf/process-pagewise&#39;, methods=[&#39;POST&#39;])
def process_pdf_pagewise():
    # 1. PDF in Seiten aufteilen (PyPDF2 oder similar)
    # 2. Pro Seite:
    #    - Text extrahieren (native/OCR je nach extractionMethod)
    #    - Markdown generieren  
    #    - Metadaten extrahieren (NER f√ºr Personen, Orte, etc.)
    #    - Bilder extrahieren (falls includeImages=true)

    return {
        &quot;status&quot;: &quot;success&quot;,
        &quot;pages&quot;: [
            {
                &quot;page_number&quot;: 1,
                &quot;markdown_content&quot;: &quot;# Seite 1 Inhalt...&quot;,
                &quot;metadata&quot;: {
                    &quot;persons&quot;: [&quot;Dr. Schmidt&quot;, &quot;Prof. Meyer&quot;], 
                    &quot;locations&quot;: [&quot;Berlin&quot;, &quot;Nordsee&quot;],
                    &quot;concepts&quot;: [&quot;Biodiversit√§t&quot;, &quot;√ñkosystem&quot;],
                    &quot;dates&quot;: [&quot;2023-05-15&quot;]
                },
                &quot;images&quot;: [&quot;page1_img1.png&quot;, &quot;page1_img2.png&quot;]
            },
            # ... weitere Seiten
        ],
        &quot;total_pages&quot;: 42
    }
</code></pre></div>
<h4 id="neuer-endpoint-pdfanalyze-chapters_1"><strong>Neuer Endpoint</strong>: <code>/pdf/analyze-chapters</code><a class="headerlink" href="#neuer-endpoint-pdfanalyze-chapters_1" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="nd">@app</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/pdf/analyze-chapters&#39;</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;POST&#39;</span><span class="p">])</span>
<span class="k">def</span><span class="w"> </span><span class="nf">analyze_chapters</span><span class="p">():</span>
    <span class="n">pages_data</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span><span class="p">[</span><span class="s1">&#39;pages&#39;</span><span class="p">]</span>

    <span class="c1"># 1. Alle Seiten zu einem Gesamt-Markdown zusammenf√ºgen</span>
    <span class="n">full_document</span> <span class="o">=</span> <span class="n">combine_pages_to_document</span><span class="p">(</span><span class="n">pages_data</span><span class="p">)</span>

    <span class="c1"># 2. LLM-Prompt f√ºr Kapitel-Erkennung</span>
    <span class="n">chapter_prompt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Analysiere dieses Dokument und erstelle eine Kapitel-Gliederung:</span>

<span class="s2">    </span><span class="si">{</span><span class="n">full_document</span><span class="si">}</span>

<span class="s2">    Erstelle eine JSON-Struktur mit:</span>
<span class="s2">    - Kapitel-Titel</span>
<span class="s2">    - Seiten-Range (von Seite X bis Seite Y)  </span>
<span class="s2">    - Kurze Kapitel-Beschreibung</span>
<span class="s2">    &quot;&quot;&quot;</span>

    <span class="n">chapters</span> <span class="o">=</span> <span class="n">llm_call</span><span class="p">(</span><span class="n">chapter_prompt</span><span class="p">)</span>

    <span class="c1"># 3. Pro Kapitel eine Zusammenfassung erstellen</span>
    <span class="k">for</span> <span class="n">chapter</span> <span class="ow">in</span> <span class="n">chapters</span><span class="p">:</span>
        <span class="n">chapter_content</span> <span class="o">=</span> <span class="n">extract_chapter_content</span><span class="p">(</span><span class="n">pages_data</span><span class="p">,</span> <span class="n">chapter</span><span class="p">[</span><span class="s1">&#39;page_range&#39;</span><span class="p">])</span>
        <span class="n">summary_prompt</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Erstelle eine Zusammenfassung f√ºr: </span><span class="si">{</span><span class="n">chapter_content</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">chapter</span><span class="p">[</span><span class="s1">&#39;summary&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">llm_call</span><span class="p">(</span><span class="n">summary_prompt</span><span class="p">)</span>
        <span class="n">chapter</span><span class="p">[</span><span class="s1">&#39;key_concepts&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">extract_key_concepts</span><span class="p">(</span><span class="n">chapter_content</span><span class="p">)</span>

    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span> 
        <span class="s2">&quot;document_title&quot;</span><span class="p">:</span> <span class="s2">&quot;Auto-generiert aus Inhalt&quot;</span><span class="p">,</span>
        <span class="s2">&quot;total_pages&quot;</span><span class="p">:</span> <span class="nb">len</span><span class="p">(</span><span class="n">pages_data</span><span class="p">),</span>
        <span class="s2">&quot;chapters&quot;</span><span class="p">:</span> <span class="n">chapters</span><span class="p">,</span>
        <span class="s2">&quot;global_metadata&quot;</span><span class="p">:</span> <span class="n">extract_global_metadata</span><span class="p">(</span><span class="n">pages_data</span><span class="p">)</span>
    <span class="p">}</span>
</code></pre></div>
<h3 id="phase-2-knowledge-scout-orchestrierung_1"><strong>Phase 2: Knowledge Scout Orchestrierung</strong><a class="headerlink" href="#phase-2-knowledge-scout-orchestrierung_1" title="Permanent link">&para;</a></h3>
<h4 id="neuer-job-typ-pdf_advanced_analysis_1"><strong>Neuer Job-Typ</strong>: <code>pdf_advanced_analysis</code><a class="headerlink" href="#neuer-job-typ-pdf_advanced_analysis_1" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="c1">// In existing Job-System</span>
<span class="p">{</span>
<span class="w">  </span><span class="nx">job_type</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;pdf_advanced_analysis&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nx">parameters</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">document_id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;doc-123&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">library_id</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;lib-456&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nx">extraction_method</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;native&quot;</span><span class="p">,</span><span class="w"> </span><span class="c1">// oder &quot;ocr&quot;, &quot;llm&quot; </span>
<span class="w">    </span><span class="nx">include_images</span><span class="o">:</span><span class="w"> </span><span class="kt">true</span><span class="p">,</span>
<span class="w">    </span><span class="nx">target_language</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;de&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h4 id="erweiterte-orchestrierung_1"><strong>Erweiterte Orchestrierung</strong>:<a class="headerlink" href="#erweiterte-orchestrierung_1" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nx">AdvancedPdfProcessor</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">processDocument</span><span class="p">(</span><span class="nx">file</span><span class="o">:</span><span class="w"> </span><span class="kt">File</span><span class="p">,</span><span class="w"> </span><span class="nx">libraryId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 1. Stufe 1: Seitenweise Verarbeitung</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">pagesResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/api/secretary/process-pdf-pagewise&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="p">,</span>
<span class="w">      </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="kt">formData</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="c1">// 2. Zwischenspeicherung f√ºr Debugging</span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">storePageResults</span><span class="p">(</span><span class="nx">pagesResult</span><span class="p">.</span><span class="nx">pages</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 3. Stufe 2: Kapitel-Analyse</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">chaptersResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">fetch</span><span class="p">(</span><span class="s1">&#39;/api/secretary/analyze-chapters&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="p">,</span><span class="w"> </span>
<span class="w">      </span><span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="kt">JSON.stringify</span><span class="p">({</span><span class="w"> </span><span class="nx">pages</span><span class="o">:</span><span class="w"> </span><span class="kt">pagesResult.pages</span><span class="w"> </span><span class="p">})</span>
<span class="w">    </span><span class="p">});</span>

<span class="w">    </span><span class="c1">// 4. Finales Shadow Twin erstellen</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">finalMarkdown</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">generateStructuredMarkdown</span><span class="p">(</span><span class="nx">chaptersResult</span><span class="p">);</span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">storeShadowTwin</span><span class="p">(</span><span class="nx">finalMarkdown</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">batch_id</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="prototyp-test-mit-echtem-biodiv-pdf_1">üß™ <strong>Prototyp-Test mit echtem Biodiv-PDF</strong><a class="headerlink" href="#prototyp-test-mit-echtem-biodiv-pdf_1" title="Permanent link">&para;</a></h2>
<h3 id="test-szenario_1"><strong>Test-Szenario</strong>:<a class="headerlink" href="#test-szenario_1" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Input</strong>: Ein 30-50 Seiten Biodiversit√§ts-PDF</li>
<li><strong>Erwartung Stufe 1</strong>: </li>
<li>Jede Seite als sauberes Markdown</li>
<li>Extrahierte Arten-Namen, Orte, Forscher pro Seite</li>
<li><strong>Erwartung Stufe 2</strong>:</li>
<li>3-5 erkannte Kapitel (Einleitung, Methoden, Ergebnisse, etc.)</li>
<li>Sinnvolle Seitenzuordnung </li>
<li>Kapitel-Zusammenfassungen mit Kernaussagen</li>
</ol>
<h3 id="success-metrics_1"><strong>Success Metrics</strong>:<a class="headerlink" href="#success-metrics_1" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Textqualit√§t</strong>: &gt; 95% korrekte Textextraktion</li>
<li><strong>Metadaten-Accuracy</strong>: &gt; 80% richtig erkannte Entit√§ten  </li>
<li><strong>Kapitel-Erkennung</strong>: Logische Gliederung, nachvollziehbar</li>
<li><strong>Performance</strong>: &lt; 5 Minuten f√ºr 50-Seiten PDF</li>
</ul>
<h2 id="nachste-schritte-entscheidung_1">‚ùì <strong>N√§chste Schritte - Entscheidung</strong><a class="headerlink" href="#nachste-schritte-entscheidung_1" title="Permanent link">&para;</a></h2>
<p><strong>Option A</strong>: Erst Secretary Service Endpoints entwickeln, dann testen
<strong>Option B</strong>: Bestehende PDF-Transformation erweitern f√ºr seitenweise Verarbeitung<br />
<strong>Option C</strong>: Mini-Prototyp mit einem 5-Seiten Test-PDF</p>
<p><strong>Was denkst du?</strong> Sollen wir mit <strong>Option C</strong> (Mini-Prototyp) anfangen, um das Konzept schnell zu validieren? Oder direkt die neuen Endpoints im Secretary Service implementieren?
<div class="highlight"><pre><span></span><code>```typescript
class AdvancedPdfProcessor {
  async processDocument(file: File, libraryId: string): Promise&lt;string&gt; {
    // 1. Stufe 1: Seitenweise Verarbeitung
    const pagesResult = await fetch(&#39;/api/secretary/process-pdf-pagewise&#39;, {
      method: &#39;POST&#39;,
      body: formData
    });

    // 2. Zwischenspeicherung f√ºr Debugging
    await this.storePageResults(pagesResult.pages);

    // 3. Stufe 2: Kapitel-Analyse
    const chaptersResult = await fetch(&#39;/api/secretary/analyze-chapters&#39;, {
      method: &#39;POST&#39;, 
      body: JSON.stringify({ pages: pagesResult.pages })
    });

    // 4. Finales Shadow Twin erstellen
    const finalMarkdown = this.generateStructuredMarkdown(chaptersResult);
    await this.storeShadowTwin(finalMarkdown);

    return batch_id;
  }
}
</code></pre></div></p>
<hr />
<p><strong>User</strong></p>
<p>Nein, die RAG-Logik ist nicht richtig formuliert. Ich brauche am Ende pro Kapitel eine Zusammenfassung mit maximal 2000 Zeichen f√ºr das Upsert in diese Dokumente von dem RAG mit Metadaten zu jedem Kapitel. 
Wenn ich im RAG eine Frage stelle, werden genau diese Kapitel-Summary-Dokumente durchsucht, eventuell gefiltert mit diesen Metadaten. Wenn ich dann beim RAG die Antwort formuliere zu gefundenen Kapiteln, verwende ich dann schon den Original-Markdown-Text von diesem Kapitel. Deswegen brauche ich neben diesem diesem Summary-Kapitel Dokument auch das Original-Markdown Dokument je Kapitel.
Um das in KnowledgeScout zu verwalten, habe ich die seitenweise Verarbeitung in einem Unterverzeichnis organisiert. Und jetzt sollte diese kapitelweise Verarbeitung in einem anderen Verzeichnis gespeichert werden. </p>
<hr />
<p><strong>Cursor</strong></p>
<p><strong>Ah, perfekt!</strong> Jetzt verstehe ich die <strong>RAG-Architektur</strong> richtig! Das ist viel klarer und effizienter als meine urspr√ºngliche Idee.</p>
<h2 id="korrekte-rag-logik">üéØ <strong>Korrekte RAG-Logik</strong><a class="headerlink" href="#korrekte-rag-logik" title="Permanent link">&para;</a></h2>
<h3 id="zwei-dokument-ansatz-pro-kapitel"><strong>Zwei-Dokument-Ansatz pro Kapitel:</strong><a class="headerlink" href="#zwei-dokument-ansatz-pro-kapitel" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Kapitel-Summary</strong> (‚â§2000 Zeichen) ‚Üí <strong>Vector Search</strong></li>
<li>Kompakte Zusammenfassung f√ºr semantische Suche</li>
<li>Metadaten als Filter (Autor, Jahr, Ort, etc.)</li>
<li>
<p>Schnell durchsuchbar</p>
</li>
<li>
<p><strong>Kapitel-Original-Markdown</strong> (vollst√§ndiger Text) ‚Üí <strong>LLM Context</strong></p>
</li>
<li>Kompletter Kapitelinhalt f√ºr detaillierte Antworten</li>
<li>Wird erst NACH der Suche geladen</li>
<li>Bessere Antwortqualit√§t durch vollst√§ndigen Kontext</li>
</ol>
<h3 id="rag-workflow"><strong>RAG-Workflow:</strong><a class="headerlink" href="#rag-workflow" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>User Query ‚Üí Vector Search (Summary-Dokumente) ‚Üí Top-K Kapitel ‚Üí Lade Original-Markdown ‚Üí LLM Response
</code></pre></div>
<h2 id="storage-organisation-im-knowledge-scout">üìÅ <strong>Storage-Organisation im Knowledge Scout</strong><a class="headerlink" href="#storage-organisation-im-knowledge-scout" title="Permanent link">&para;</a></h2>
<h3 id="verzeichnis-struktur"><strong>Verzeichnis-Struktur:</strong><a class="headerlink" href="#verzeichnis-struktur" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>/dokument-xyz/
‚îú‚îÄ‚îÄ pages/                    # Seitenweise Verarbeitung
‚îÇ   ‚îú‚îÄ‚îÄ page-001.md
‚îÇ   ‚îú‚îÄ‚îÄ page-002.md
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ chapters/                 # Kapitelweise Verarbeitung  
‚îÇ   ‚îú‚îÄ‚îÄ chapter-01-summary.md      # F√ºr Vector Search
‚îÇ   ‚îú‚îÄ‚îÄ chapter-01-full.md         # F√ºr LLM Context
‚îÇ   ‚îú‚îÄ‚îÄ chapter-02-summary.md
‚îÇ   ‚îú‚îÄ‚îÄ chapter-02-full.md
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ document-metadata.json    # Globale Metadaten
</code></pre></div>
<h2 id="angepasster-prototyp-workflow">üîÑ <strong>Angepasster Prototyp-Workflow</strong><a class="headerlink" href="#angepasster-prototyp-workflow" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code>User Query ‚Üí Vector Search (Summary-Dokumente) ‚Üí Top-K Kapitel ‚Üí Lade Original-Markdown ‚Üí LLM Response
</code></pre></div>
<div class="highlight"><pre><span></span><code>/dokument-xyz/
‚îú‚îÄ‚îÄ pages/                    # Seitenweise Verarbeitung
‚îÇ   ‚îú‚îÄ‚îÄ page-001.md
‚îÇ   ‚îú‚îÄ‚îÄ page-002.md
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îú‚îÄ‚îÄ chapters/                 # Kapitelweise Verarbeitung  
‚îÇ   ‚îú‚îÄ‚îÄ chapter-01-summary.md      # F√ºr Vector Search
‚îÇ   ‚îú‚îÄ‚îÄ chapter-01-full.md         # F√ºr LLM Context
‚îÇ   ‚îú‚îÄ‚îÄ chapter-02-summary.md
‚îÇ   ‚îú‚îÄ‚îÄ chapter-02-full.md
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ document-metadata.json    # Globale Metadaten
</code></pre></div>
<h3 id="stufe-1-seitenweise-verarbeitung-unverandert"><strong>Stufe 1: Seitenweise Verarbeitung</strong> (unver√§ndert)<a class="headerlink" href="#stufe-1-seitenweise-verarbeitung-unverandert" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Secretary Service: /pdf/process-pagewise</span>
<span class="err">‚Üí</span> <span class="n">Speichere</span> <span class="ow">in</span><span class="p">:</span> <span class="o">/</span><span class="n">dokument</span><span class="o">-</span><span class="n">xyz</span><span class="o">/</span><span class="n">pages</span><span class="o">/</span><span class="n">page</span><span class="o">-</span><span class="mf">001.</span><span class="n">md</span><span class="p">,</span> <span class="n">page</span><span class="o">-</span><span class="mf">002.</span><span class="n">md</span><span class="p">,</span> <span class="o">...</span>
</code></pre></div>
<h3 id="stufe-2-kapitel-analyse-angepasst"><strong>Stufe 2: Kapitel-Analyse</strong> (angepasst)<a class="headerlink" href="#stufe-2-kapitel-analyse-angepasst" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1"># Secretary Service: /pdf/analyze-chapters  </span>
<span class="err">‚Üí</span> <span class="n">Pro</span> <span class="n">Kapitel</span> <span class="n">erstelle</span><span class="p">:</span>
  <span class="mf">1.</span> <span class="n">Summary</span> <span class="p">(</span><span class="err">‚â§</span><span class="mi">2000</span> <span class="n">Zeichen</span><span class="p">)</span> <span class="o">+</span> <span class="n">Metadaten</span>
  <span class="mf">2.</span> <span class="n">Full</span><span class="o">-</span><span class="n">Markdown</span> <span class="p">(</span><span class="n">kompletter</span> <span class="n">Kapiteltext</span><span class="p">)</span>
</code></pre></div>
<h3 id="stufe-3-storage-im-knowledge-scout"><strong>Stufe 3: Storage im Knowledge Scout</strong><a class="headerlink" href="#stufe-3-storage-im-knowledge-scout" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="c1">// Speichere pro Kapitel:</span>
<span class="k">await</span><span class="w"> </span><span class="nx">provider</span><span class="p">.</span><span class="nx">saveText</span><span class="p">(</span><span class="sb">`/chapters/chapter-</span><span class="si">${</span><span class="nx">i</span><span class="si">}</span><span class="sb">-summary.md`</span><span class="p">,</span><span class="w"> </span><span class="nx">summary</span><span class="p">);</span>
<span class="k">await</span><span class="w"> </span><span class="nx">provider</span><span class="p">.</span><span class="nx">saveText</span><span class="p">(</span><span class="sb">`/chapters/chapter-</span><span class="si">${</span><span class="nx">i</span><span class="si">}</span><span class="sb">-full.md`</span><span class="p">,</span><span class="w"> </span><span class="nx">fullContent</span><span class="p">);</span>
</code></pre></div>
<h2 id="angepasste-secretary-service-endpoints">üõ†Ô∏è <strong>Angepasste Secretary Service Endpoints</strong><a class="headerlink" href="#angepasste-secretary-service-endpoints" title="Permanent link">&para;</a></h2>
<h3 id="pdfanalyze-chapters-response"><strong><code>/pdf/analyze-chapters</code> Response:</strong><a class="headerlink" href="#pdfanalyze-chapters-response" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="k">return</span> <span class="p">{</span>
    <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
    <span class="s2">&quot;chapters&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;chapter_number&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Einleitung zur Biodiversit√§t&quot;</span><span class="p">,</span>
            <span class="s2">&quot;page_range&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>

            <span class="c1"># F√ºr Vector Search (‚â§2000 Zeichen)</span>
            <span class="s2">&quot;summary&quot;</span><span class="p">:</span> <span class="s2">&quot;Diese Einleitung behandelt die Grundlagen der Biodiversit√§t im Wattenmeer. Schwerpunkte sind die Artenvielfalt von Muscheln und Wattw√ºrmern sowie der Einfluss des Klimawandels auf das √ñkosystem. Wichtige Erkenntnisse: 15% Artenverlust seit 1990, besonders kritisch bei endemischen Arten...&quot;</span><span class="p">,</span>

            <span class="c1"># Vollst√§ndiger Kapiteltext (f√ºr LLM Context)  </span>
            <span class="s2">&quot;full_content&quot;</span><span class="p">:</span> <span class="s2">&quot;# Kapitel 1: Einleitung zur Biodiversit√§t</span><span class="se">\n\n</span><span class="s2">Das Wattenmeer ist eines der produktivsten √ñkosysteme...[VOLLST√ÑNDIGER TEXT]&quot;</span><span class="p">,</span>

            <span class="c1"># Metadaten f√ºr Filterung</span>
            <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;primary_species&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Arenicola marina&quot;</span><span class="p">,</span> <span class="s2">&quot;Mytilus edulis&quot;</span><span class="p">],</span>
                <span class="s2">&quot;locations&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Sylt&quot;</span><span class="p">,</span> <span class="s2">&quot;Wattenmeer&quot;</span><span class="p">,</span> <span class="s2">&quot;Nordsee&quot;</span><span class="p">],</span>
                <span class="s2">&quot;time_period&quot;</span><span class="p">:</span> <span class="s2">&quot;1990-2023&quot;</span><span class="p">,</span> 
                <span class="s2">&quot;methods&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Feldbeobachtung&quot;</span><span class="p">,</span> <span class="s2">&quot;Probenentnahme&quot;</span><span class="p">],</span>
                <span class="s2">&quot;key_concepts&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Biodiversit√§t&quot;</span><span class="p">,</span> <span class="s2">&quot;Klimawandel&quot;</span><span class="p">,</span> <span class="s2">&quot;Artenverlust&quot;</span><span class="p">],</span>
                <span class="s2">&quot;authors_mentioned&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Dr. Schmidt&quot;</span><span class="p">,</span> <span class="s2">&quot;Prof. Meyer&quot;</span><span class="p">],</span>
                <span class="s2">&quot;significance&quot;</span><span class="p">:</span> <span class="s2">&quot;high&quot;</span>  <span class="c1"># high/medium/low</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;chapter_number&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Methodologie der Datenerhebung&quot;</span><span class="p">,</span>
            <span class="c1"># ... weitere Kapitel</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="knowledge-scout-storage-logik">üìÇ <strong>Knowledge Scout Storage-Logik</strong><a class="headerlink" href="#knowledge-scout-storage-logik" title="Permanent link">&para;</a></h2>
<h3 id="erweiterte-storageprovider-integration"><strong>Erweiterte StorageProvider Integration:</strong><a class="headerlink" href="#erweiterte-storageprovider-integration" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nx">ChapterProcessor</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">storeChapterResults</span><span class="p">(</span>
<span class="w">    </span><span class="nx">chapters</span><span class="o">:</span><span class="w"> </span><span class="kt">ChapterData</span><span class="p">[],</span><span class="w"> </span>
<span class="w">    </span><span class="nx">documentId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">    </span><span class="nx">provider</span><span class="o">:</span><span class="w"> </span><span class="kt">StorageProvider</span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">chapter</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">chapters</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">chapterNum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">chapter</span><span class="p">.</span><span class="nx">chapter_number</span><span class="p">.</span><span class="nx">toString</span><span class="p">().</span><span class="nx">padStart</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 1. Summary-Dokument f√ºr RAG Vector Search</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">summaryContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">createSummaryMarkdown</span><span class="p">(</span><span class="nx">chapter</span><span class="p">);</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="nx">provider</span><span class="p">.</span><span class="nx">saveText</span><span class="p">(</span>
<span class="w">        </span><span class="sb">`/chapters/chapter-</span><span class="si">${</span><span class="nx">chapterNum</span><span class="si">}</span><span class="sb">-summary.md`</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="nx">summaryContent</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 2. Full-Content-Dokument f√ºr LLM Context</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="nx">provider</span><span class="p">.</span><span class="nx">saveText</span><span class="p">(</span>
<span class="w">        </span><span class="sb">`/chapters/chapter-</span><span class="si">${</span><span class="nx">chapterNum</span><span class="si">}</span><span class="sb">-full.md`</span><span class="p">,</span>
<span class="w">        </span><span class="nx">chapter</span><span class="p">.</span><span class="nx">full_content</span><span class="w">  </span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 3. Metadaten separat f√ºr schnellen Zugriff</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="nx">provider</span><span class="p">.</span><span class="nx">saveText</span><span class="p">(</span>
<span class="w">        </span><span class="sb">`/chapters/chapter-</span><span class="si">${</span><span class="nx">chapterNum</span><span class="si">}</span><span class="sb">-metadata.json`</span><span class="p">,</span>
<span class="w">        </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">metadata</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">createSummaryMarkdown</span><span class="p">(</span><span class="nx">chapter</span><span class="o">:</span><span class="w"> </span><span class="kt">ChapterData</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="sb">`---</span>
<span class="sb">title: &quot;</span><span class="si">${</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">title</span><span class="si">}</span><span class="sb">&quot;</span>
<span class="sb">chapter_number: </span><span class="si">${</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">chapter_number</span><span class="si">}</span>
<span class="sb">page_range: [</span><span class="si">${</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">page_range</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">]</span>
<span class="sb">document_id: &quot;</span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">documentId</span><span class="si">}</span><span class="sb">&quot;</span>

<span class="sb"># Metadaten f√ºr RAG-Filterung</span>
<span class="sb">primary_species: </span><span class="si">${</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">primary_species</span><span class="p">)</span><span class="si">}</span>
<span class="sb">locations: </span><span class="si">${</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">locations</span><span class="p">)</span><span class="si">}</span><span class="sb">  </span>
<span class="sb">time_period: &quot;</span><span class="si">${</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">time_period</span><span class="si">}</span><span class="sb">&quot;</span>
<span class="sb">methods: </span><span class="si">${</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">methods</span><span class="p">)</span><span class="si">}</span>
<span class="sb">key_concepts: </span><span class="si">${</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">key_concepts</span><span class="p">)</span><span class="si">}</span>
<span class="sb">significance: &quot;</span><span class="si">${</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">significance</span><span class="si">}</span><span class="sb">&quot;</span>
<span class="sb">---</span>

<span class="sb"># </span><span class="si">${</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">title</span><span class="si">}</span>

<span class="si">${</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">summary</span><span class="si">}</span>

<span class="sb">&lt;!-- Limitiert auf maximal 2000 Zeichen f√ºr effizienten Vector Search --&gt;`</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="rag-integration-vorbereitung">üéØ <strong>RAG-Integration Vorbereitung</strong><a class="headerlink" href="#rag-integration-vorbereitung" title="Permanent link">&para;</a></h2>
<h3 id="vector-search-index"><strong>Vector Search Index:</strong><a class="headerlink" href="#vector-search-index" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kd">interface</span><span class="w"> </span><span class="nx">RAGChapterIndex</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">chapter_id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">document_id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">summary_path</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">        </span><span class="c1">// /chapters/chapter-01-summary.md</span>
<span class="w">  </span><span class="nx">full_content_path</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">   </span><span class="c1">// /chapters/chapter-01-full.md</span>

<span class="w">  </span><span class="c1">// F√ºr Vector Search</span>
<span class="w">  </span><span class="nx">summary_embedding</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[];</span>

<span class="w">  </span><span class="c1">// F√ºr Metadaten-Filter</span>
<span class="w">  </span><span class="nx">filterable_metadata</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">species</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">    </span><span class="nx">locations</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">    </span><span class="nx">time_period</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">    </span><span class="nx">significance</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;high&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;medium&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;low&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// ... weitere Filter</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="rag-query-workflow"><strong>RAG Query Workflow:</strong><a class="headerlink" href="#rag-query-workflow" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nx">RAGQueryProcessor</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">processQuery</span><span class="p">(</span><span class="nx">query</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">filters?</span><span class="o">:</span><span class="w"> </span><span class="kt">MetadataFilters</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 1. Vector Search in Summary-Dokumenten</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">relevantChapters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">vectorSearch</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span><span class="w"> </span><span class="nx">filters</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 2. Lade Full-Content der Top-K Kapitel</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">fullContexts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nb">Promise</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span>
<span class="w">      </span><span class="nx">relevantChapters</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">chapter</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">provider</span><span class="p">.</span><span class="nx">getText</span><span class="p">(</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">full_content_path</span><span class="p">)</span>
<span class="w">      </span><span class="p">)</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 3. LLM mit vollst√§ndigem Kontext</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">llm</span><span class="p">.</span><span class="nx">generateAnswer</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span><span class="w"> </span><span class="nx">fullContexts</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">response</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<h2 id="angepasster-prototyp-test">üß™ <strong>Angepasster Prototyp-Test</strong><a class="headerlink" href="#angepasster-prototyp-test" title="Permanent link">&para;</a></h2>
<h3 id="test-ziele"><strong>Test-Ziele:</strong><a class="headerlink" href="#test-ziele" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Summary-Qualit√§t</strong>: Sind 2000 Zeichen ausreichend f√ºr gute Vector Search?</li>
<li><strong>Metadaten-Vollst√§ndigkeit</strong>: Werden alle relevanten Entit√§ten extrahiert?</li>
<li><strong>Kapitel-Abgrenzung</strong>: Sind die Kapitel logisch und vollst√§ndig?</li>
<li><strong>Storage-Effizienz</strong>: Funktioniert die Verzeichnis-Organisation?</li>
</ol>
<h3 id="erfolgs-kriterien"><strong>Erfolgs-Kriterien:</strong><a class="headerlink" href="#erfolgs-kriterien" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Summary-Coverage</strong>: Alle Kernaussagen in ‚â§2000 Zeichen</li>
<li><strong>Metadaten-Accuracy</strong>: &gt;85% korrekte Entit√§ts-Extraktion</li>
<li><strong>Storage-Organisation</strong>: Saubere Trennung pages/ vs. chapters/</li>
<li><strong>RAG-Readiness</strong>: Summaries sind searchable, Full-Content ist context-rich</li>
</ul>
<p><strong>Sollen wir mit diesem korrigierten Ansatz den Prototyp angehen?</strong> Die RAG-Architektur ist jetzt viel klarer und effizienter!</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Secretary Service: /pdf/process-pagewise</span>
<span class="err">‚Üí</span> <span class="n">Speichere</span> <span class="ow">in</span><span class="p">:</span> <span class="o">/</span><span class="n">dokument</span><span class="o">-</span><span class="n">xyz</span><span class="o">/</span><span class="n">pages</span><span class="o">/</span><span class="n">page</span><span class="o">-</span><span class="mf">001.</span><span class="n">md</span><span class="p">,</span> <span class="n">page</span><span class="o">-</span><span class="mf">002.</span><span class="n">md</span><span class="p">,</span> <span class="o">...</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Secretary Service: /pdf/analyze-chapters  </span>
<span class="err">‚Üí</span> <span class="n">Pro</span> <span class="n">Kapitel</span> <span class="n">erstelle</span><span class="p">:</span>
  <span class="mf">1.</span> <span class="n">Summary</span> <span class="p">(</span><span class="err">‚â§</span><span class="mi">2000</span> <span class="n">Zeichen</span><span class="p">)</span> <span class="o">+</span> <span class="n">Metadaten</span>
  <span class="mf">2.</span> <span class="n">Full</span><span class="o">-</span><span class="n">Markdown</span> <span class="p">(</span><span class="n">kompletter</span> <span class="n">Kapiteltext</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Secretary Service: /pdf/process-pagewise</span>
<span class="err">‚Üí</span> <span class="n">Speichere</span> <span class="ow">in</span><span class="p">:</span> <span class="o">/</span><span class="n">dokument</span><span class="o">-</span><span class="n">xyz</span><span class="o">/</span><span class="n">pages</span><span class="o">/</span><span class="n">page</span><span class="o">-</span><span class="mf">001.</span><span class="n">md</span><span class="p">,</span> <span class="n">page</span><span class="o">-</span><span class="mf">002.</span><span class="n">md</span><span class="p">,</span> <span class="o">...</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1"># Secretary Service: /pdf/analyze-chapters  </span>
<span class="err">‚Üí</span> <span class="n">Pro</span> <span class="n">Kapitel</span> <span class="n">erstelle</span><span class="p">:</span>
  <span class="mf">1.</span> <span class="n">Summary</span> <span class="p">(</span><span class="err">‚â§</span><span class="mi">2000</span> <span class="n">Zeichen</span><span class="p">)</span> <span class="o">+</span> <span class="n">Metadaten</span>
  <span class="mf">2.</span> <span class="n">Full</span><span class="o">-</span><span class="n">Markdown</span> <span class="p">(</span><span class="n">kompletter</span> <span class="n">Kapiteltext</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="c1">// Speichere pro Kapitel:</span>
<span class="k">await</span><span class="w"> </span><span class="nx">provider</span><span class="p">.</span><span class="nx">saveText</span><span class="p">(</span><span class="sb">`/chapters/chapter-</span><span class="si">${</span><span class="nx">i</span><span class="si">}</span><span class="sb">-summary.md`</span><span class="p">,</span><span class="w"> </span><span class="nx">summary</span><span class="p">);</span>
<span class="k">await</span><span class="w"> </span><span class="nx">provider</span><span class="p">.</span><span class="nx">saveText</span><span class="p">(</span><span class="sb">`/chapters/chapter-</span><span class="si">${</span><span class="nx">i</span><span class="si">}</span><span class="sb">-full.md`</span><span class="p">,</span><span class="w"> </span><span class="nx">fullContent</span><span class="p">);</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="k">return</span> <span class="p">{</span>
    <span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;success&quot;</span><span class="p">,</span>
    <span class="s2">&quot;chapters&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
            <span class="s2">&quot;chapter_number&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
            <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Einleitung zur Biodiversit√§t&quot;</span><span class="p">,</span>
            <span class="s2">&quot;page_range&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>

            <span class="c1"># F√ºr Vector Search (‚â§2000 Zeichen)</span>
            <span class="s2">&quot;summary&quot;</span><span class="p">:</span> <span class="s2">&quot;Diese Einleitung behandelt die Grundlagen der Biodiversit√§t im Wattenmeer. Schwerpunkte sind die Artenvielfalt von Muscheln und Wattw√ºrmern sowie der Einfluss des Klimawandels auf das √ñkosystem. Wichtige Erkenntnisse: 15% Artenverlust seit 1990, besonders kritisch bei endemischen Arten...&quot;</span><span class="p">,</span>

            <span class="c1"># Vollst√§ndiger Kapiteltext (f√ºr LLM Context)  </span>
            <span class="s2">&quot;full_content&quot;</span><span class="p">:</span> <span class="s2">&quot;# Kapitel 1: Einleitung zur Biodiversit√§t</span><span class="se">\n\n</span><span class="s2">Das Wattenmeer ist eines der produktivsten √ñkosysteme...[VOLLST√ÑNDIGER TEXT]&quot;</span><span class="p">,</span>

            <span class="c1"># Metadaten f√ºr Filterung</span>
            <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;primary_species&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Arenicola marina&quot;</span><span class="p">,</span> <span class="s2">&quot;Mytilus edulis&quot;</span><span class="p">],</span>
                <span class="s2">&quot;locations&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Sylt&quot;</span><span class="p">,</span> <span class="s2">&quot;Wattenmeer&quot;</span><span class="p">,</span> <span class="s2">&quot;Nordsee&quot;</span><span class="p">],</span>
                <span class="s2">&quot;time_period&quot;</span><span class="p">:</span> <span class="s2">&quot;1990-2023&quot;</span><span class="p">,</span> 
                <span class="s2">&quot;methods&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Feldbeobachtung&quot;</span><span class="p">,</span> <span class="s2">&quot;Probenentnahme&quot;</span><span class="p">],</span>
                <span class="s2">&quot;key_concepts&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Biodiversit√§t&quot;</span><span class="p">,</span> <span class="s2">&quot;Klimawandel&quot;</span><span class="p">,</span> <span class="s2">&quot;Artenverlust&quot;</span><span class="p">],</span>
                <span class="s2">&quot;authors_mentioned&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Dr. Schmidt&quot;</span><span class="p">,</span> <span class="s2">&quot;Prof. Meyer&quot;</span><span class="p">],</span>
                <span class="s2">&quot;significance&quot;</span><span class="p">:</span> <span class="s2">&quot;high&quot;</span>  <span class="c1"># high/medium/low</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="s2">&quot;chapter_number&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Methodologie der Datenerhebung&quot;</span><span class="p">,</span>
            <span class="c1"># ... weitere Kapitel</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nx">ChapterProcessor</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">storeChapterResults</span><span class="p">(</span>
<span class="w">    </span><span class="nx">chapters</span><span class="o">:</span><span class="w"> </span><span class="kt">ChapterData</span><span class="p">[],</span><span class="w"> </span>
<span class="w">    </span><span class="nx">documentId</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span>
<span class="w">    </span><span class="nx">provider</span><span class="o">:</span><span class="w"> </span><span class="kt">StorageProvider</span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kd">const</span><span class="w"> </span><span class="nx">chapter</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="nx">chapters</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">chapterNum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">chapter</span><span class="p">.</span><span class="nx">chapter_number</span><span class="p">.</span><span class="nx">toString</span><span class="p">().</span><span class="nx">padStart</span><span class="p">(</span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 1. Summary-Dokument f√ºr RAG Vector Search</span>
<span class="w">      </span><span class="kd">const</span><span class="w"> </span><span class="nx">summaryContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">createSummaryMarkdown</span><span class="p">(</span><span class="nx">chapter</span><span class="p">);</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="nx">provider</span><span class="p">.</span><span class="nx">saveText</span><span class="p">(</span>
<span class="w">        </span><span class="sb">`/chapters/chapter-</span><span class="si">${</span><span class="nx">chapterNum</span><span class="si">}</span><span class="sb">-summary.md`</span><span class="p">,</span><span class="w"> </span>
<span class="w">        </span><span class="nx">summaryContent</span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 2. Full-Content-Dokument f√ºr LLM Context</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="nx">provider</span><span class="p">.</span><span class="nx">saveText</span><span class="p">(</span>
<span class="w">        </span><span class="sb">`/chapters/chapter-</span><span class="si">${</span><span class="nx">chapterNum</span><span class="si">}</span><span class="sb">-full.md`</span><span class="p">,</span>
<span class="w">        </span><span class="nx">chapter</span><span class="p">.</span><span class="nx">full_content</span><span class="w">  </span>
<span class="w">      </span><span class="p">);</span>

<span class="w">      </span><span class="c1">// 3. Metadaten separat f√ºr schnellen Zugriff</span>
<span class="w">      </span><span class="k">await</span><span class="w"> </span><span class="nx">provider</span><span class="p">.</span><span class="nx">saveText</span><span class="p">(</span>
<span class="w">        </span><span class="sb">`/chapters/chapter-</span><span class="si">${</span><span class="nx">chapterNum</span><span class="si">}</span><span class="sb">-metadata.json`</span><span class="p">,</span>
<span class="w">        </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">metadata</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">)</span>
<span class="w">      </span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">private</span><span class="w"> </span><span class="nx">createSummaryMarkdown</span><span class="p">(</span><span class="nx">chapter</span><span class="o">:</span><span class="w"> </span><span class="kt">ChapterData</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="sb">`---</span>
<span class="sb">title: &quot;</span><span class="si">${</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">title</span><span class="si">}</span><span class="sb">&quot;</span>
<span class="sb">chapter_number: </span><span class="si">${</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">chapter_number</span><span class="si">}</span>
<span class="sb">page_range: [</span><span class="si">${</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">page_range</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span><span class="si">}</span><span class="sb">]</span>
<span class="sb">document_id: &quot;</span><span class="si">${</span><span class="k">this</span><span class="p">.</span><span class="nx">documentId</span><span class="si">}</span><span class="sb">&quot;</span>

<span class="sb"># Metadaten f√ºr RAG-Filterung</span>
<span class="sb">primary_species: </span><span class="si">${</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">primary_species</span><span class="p">)</span><span class="si">}</span>
<span class="sb">locations: </span><span class="si">${</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">locations</span><span class="p">)</span><span class="si">}</span><span class="sb">  </span>
<span class="sb">time_period: &quot;</span><span class="si">${</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">time_period</span><span class="si">}</span><span class="sb">&quot;</span>
<span class="sb">methods: </span><span class="si">${</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">methods</span><span class="p">)</span><span class="si">}</span>
<span class="sb">key_concepts: </span><span class="si">${</span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">(</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">key_concepts</span><span class="p">)</span><span class="si">}</span>
<span class="sb">significance: &quot;</span><span class="si">${</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">metadata</span><span class="p">.</span><span class="nx">significance</span><span class="si">}</span><span class="sb">&quot;</span>
<span class="sb">---</span>

<span class="sb"># </span><span class="si">${</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">title</span><span class="si">}</span>

<span class="si">${</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">summary</span><span class="si">}</span>

<span class="sb">&lt;!-- Limitiert auf maximal 2000 Zeichen f√ºr effizienten Vector Search --&gt;`</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kd">interface</span><span class="w"> </span><span class="nx">RAGChapterIndex</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">chapter_id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">document_id</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">  </span><span class="nx">summary_path</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">        </span><span class="c1">// /chapters/chapter-01-summary.md</span>
<span class="w">  </span><span class="nx">full_content_path</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span><span class="w">   </span><span class="c1">// /chapters/chapter-01-full.md</span>

<span class="w">  </span><span class="c1">// F√ºr Vector Search</span>
<span class="w">  </span><span class="nx">summary_embedding</span><span class="o">:</span><span class="w"> </span><span class="kt">number</span><span class="p">[];</span>

<span class="w">  </span><span class="c1">// F√ºr Metadaten-Filter</span>
<span class="w">  </span><span class="nx">filterable_metadata</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nx">species</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">    </span><span class="nx">locations</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">[];</span>
<span class="w">    </span><span class="nx">time_period</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">;</span>
<span class="w">    </span><span class="nx">significance</span><span class="o">:</span><span class="w"> </span><span class="s1">&#39;high&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;medium&#39;</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="s1">&#39;low&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="c1">// ... weitere Filter</span>
<span class="w">  </span><span class="p">};</span>
<span class="p">}</span>
</code></pre></div>
<div class="highlight"><pre><span></span><code><span class="kd">class</span><span class="w"> </span><span class="nx">RAGQueryProcessor</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">async</span><span class="w"> </span><span class="nx">processQuery</span><span class="p">(</span><span class="nx">query</span><span class="o">:</span><span class="w"> </span><span class="kt">string</span><span class="p">,</span><span class="w"> </span><span class="nx">filters?</span><span class="o">:</span><span class="w"> </span><span class="kt">MetadataFilters</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="nb">Promise</span><span class="o">&lt;</span><span class="kt">string</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// 1. Vector Search in Summary-Dokumenten</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">relevantChapters</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">vectorSearch</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span><span class="w"> </span><span class="nx">filters</span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 2. Lade Full-Content der Top-K Kapitel</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">fullContexts</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nb">Promise</span><span class="p">.</span><span class="nx">all</span><span class="p">(</span>
<span class="w">      </span><span class="nx">relevantChapters</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">chapter</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span>
<span class="w">        </span><span class="k">this</span><span class="p">.</span><span class="nx">provider</span><span class="p">.</span><span class="nx">getText</span><span class="p">(</span><span class="nx">chapter</span><span class="p">.</span><span class="nx">full_content_path</span><span class="p">)</span>
<span class="w">      </span><span class="p">)</span>
<span class="w">    </span><span class="p">);</span>

<span class="w">    </span><span class="c1">// 3. LLM mit vollst√§ndigem Kontext</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">response</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="nx">llm</span><span class="p">.</span><span class="nx">generateAnswer</span><span class="p">(</span><span class="nx">query</span><span class="p">,</span><span class="w"> </span><span class="nx">fullContexts</span><span class="p">);</span>

<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">response</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="../../js/print-site.js"></script>
      
        <script src="https://unpkg.com/mermaid@10.9.1/dist/mermaid.min.js"></script>
      
        <script src="../../assets/javascripts/mermaid-init.js"></script>
      
    
  </body>
</html>